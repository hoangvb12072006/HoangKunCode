<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HOANGKUN STORE - PREMIUM GAMING SHOP</title>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <style>

        .logo:hover {
    filter: brightness(1.2); /* L√†m logo s√°ng h∆°n khi di chu·ªôt */
    text-shadow: 0 0 8px var(--primary); /* T·∫°o hi·ªáu ·ª©ng h√†o quang */
    transition: 0.3s;
}

        footer a:hover {
    color: var(--primary) !important;
    transition: 0.3s;
}

        /* Hi·ªáu ·ª©ng ch·ªØ l∆∞·ªõt s√°ng Gradient */
.glow-text {
    background: linear-gradient(to right, #ff0000 20%, #ffffff 40%, #ff4d4d 60%, #ff0000 80%);
    background-size: 200% auto;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    animation: shine-glow 4s linear infinite;
}

@keyframes shine-glow {
    to { background-position: 200% center; }
}

/* Hi·ªáu ·ª©ng d√≤ng ch·ªØ ph·ª• bay l√™n nh·∫π nh√†ng */
.sub-text {
    animation: fadeInUp 1.5s ease-out;
}

@keyframes fadeInUp {
    from { opacity: 0; transform: translateY(30px); }
    to { opacity: 0.9; transform: translateY(0); }
}

/* Hi·ªáu ·ª©ng bo g√≥c v√† ƒë·ªï b√≥ng cho ·∫£nh s·∫£n ph·∫©m */
.thumb img {
    transition: transform 0.5s ease;
}
.card:hover .thumb img {
    transform: scale(1.1); /* Ph√≥ng to nh·∫π ·∫£nh khi di chu·ªôt v√†o */
}

/* L√†m cho c√°c n√∫t li√™n h·ªá (Zalo, FB) rung nh·∫π ƒë·ªÉ thu h√∫t s·ª± ch√∫ √Ω */
@keyframes shake {
    0% { transform: rotate(0deg); }
    25% { transform: rotate(5deg); }
    50% { transform: rotate(-5deg); }
    100% { transform: rotate(0deg); }
}
.contact-item {
    animation: shake 2s infinite ease-in-out;
}

        .contact-sidebar {
    position: fixed;
    right: 20px;
    bottom: 80px;
    z-index: 999;
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.contact-item {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    color: white;
    text-decoration: none;
    font-size: 24px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    transition: 0.3s;
}

.contact-item:hover {
    transform: scale(1.1) translateX(-5px);
}

.zalo { background: #0068ff; }
.facebook { background: #1877f2; }
.telegram { background: #229ed9; }
        
        :root { --primary: #ff0000; --secondary: #121212; --accent: #ff4d4d; --text: #ffffff; --bg: #050505; --card-bg: #1a1a1a; }
        body { margin: 0; padding: 0; background-color: var(--bg); color: var(--text); font-family: 'Segoe UI', sans-serif; overflow-x: hidden; }
        
        /* Hi·ªáu ·ª©ng h·∫°t n·ªÅn */
        #particleCanvas { position: fixed; top: 0; left: 0; z-index: -1; background: radial-gradient(circle, #1a0000 0%, #050505 100%); }
        
        /* Navigation Bar */
        nav { background: rgba(0, 0, 0, 0.85); border-bottom: 2px solid var(--primary); padding: 15px 0; position: sticky; top: 0; z-index: 100; backdrop-filter: blur(15px); }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        .nav-content { display: flex; justify-content: space-between; align-items: center; }
/* T√¨m ƒë·∫øn d√≤ng 24 v√† thay b·∫±ng ƒëo·∫°n n√†y */
.logo {
    font-size: 26px;
    font-weight: 900;
    text-transform: uppercase;
    animation: rgb-glow 4s infinite linear; /* Th√™m d√≤ng n√†y ƒë·ªÉ k√≠ch ho·∫°t ƒë·ªïi m√†u */
}

/* Th√™m hi·ªáu ·ª©ng ch·∫°y m√†u v√†o b·∫•t k·ª≥ ƒë√¢u trong th·∫ª <style> */
@keyframes rgb-glow {
    0% { color: #ff0000; text-shadow: 0 0 15px #ff0000; }
    33% { color: #00ff00; text-shadow: 0 0 15px #00ff00; }
    66% { color: #00ffff; text-shadow: 0 0 15px #00ffff; }
    100% { color: #ff0000; text-shadow: 0 0 15px #ff0000; }
}
        /* N√∫t b·∫•m x·ªãn */
        .btn { padding: 10px 20px; border-radius: 8px; border: none; font-weight: bold; cursor: pointer; transition: 0.3s; text-transform: uppercase; }
        .btn-red { background: var(--primary); color: white; box-shadow: 0 0 15px rgba(255, 0, 0, 0.4); }
        .btn-red:hover { background: #ff3333; transform: scale(1.05); }
        
        /* Grid S·∫£n ph·∫©m */
        .shop-title { border-left: 5px solid var(--primary); padding-left: 15px; margin: 40px 0 20px; font-size: 22px; text-transform: uppercase; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 25px; }
        .card { background: var(--card-bg); border-radius: 15px; overflow: hidden; border: 1px solid #222; transition: 0.4s; position: relative; }
        .card:hover { transform: translateY(-10px); border-color: var(--primary); box-shadow: 0 10px 30px rgba(255,0,0,0.1); }
        .thumb { height: 180px; width: 100%; }
        .thumb img { width: 100%; height: 100%; object-fit: cover; }
        .card-body { padding: 20px; text-align: center; }
        .price { color: var(--primary); font-size: 22px; font-weight: 800; margin: 10px 0; }

        /* Modal h·ªá th·ªëng */
        .modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); display: none; align-items: center; justify-content: center; z-index: 1000; backdrop-filter: blur(10px); }
        .modal-content { background: #151515; padding: 35px; border-radius: 20px; border: 1px solid #333; max-width: 400px; width: 90%; text-align: center; position: relative; }
        .input-group { position: relative; margin-bottom: 15px; text-align: left; }
        .input-group input { width: 100%; padding: 12px 15px; background: #000; border: 1px solid #333; border-radius: 8px; color: #fff; box-sizing: border-box; outline: none; }
        .input-group input:focus { border-color: var(--primary); }
        
        /* Th√¥ng b√°o gi·∫£ l·∫≠p */
        .fake-noti { position: fixed; bottom: -100px; left: 20px; background: rgba(20, 20, 20, 0.95); padding: 12px 20px; border-left: 4px solid var(--primary); border-radius: 8px; transition: 0.5s; z-index: 999; display: flex; align-items: center; gap: 10px; font-size: 14px; }
        .fake-noti.show { bottom: 20px; }

        /* L·ªãch s·ª≠ mua h√†ng */
        .history-box { margin-top: 50px; background: #111; padding: 20px; border-radius: 15px; border: 1px solid #222; }
        table { width: 100%; border-collapse: collapse; margin-top: 15px; font-size: 14px; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #222; }
        th { color: var(--primary); }
        
    </style>
</head>
<body>

    <canvas id="particleCanvas" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; pointer-events: none;"></canvas>

<nav>
    <div class="container nav-content">
       <div class="logo">
    <a href="index.html" style="text-decoration: none; color: inherit;">
        <h1 style="margin: 0; cursor: pointer;">HOANGKUNSTORE</h1>
    </a>
</div>
        <div id="auth-section">
            <button class="btn btn-red" onclick="showAuth(false)">ƒêƒÇNG NH·∫¨P / ƒêƒÇNG K√ù</button>
        </div>
        <div id="user-section" style="display: none; align-items: center; gap: 15px;">
            <div style="font-size: 14px;">Xin ch√†o, <b id="display-name" style="color:var(--primary)">...</b></div>
            <div style="background: #222; padding: 5px 12px; border-radius: 20px; font-size: 14px;">
                <i class="fas fa-wallet" style="color:#00ff00"></i> <span id="user-balance">0ƒë</span>
            </div>
            <button class="btn btn-red" style="padding: 5px 10px; font-size: 12px;" onclick="showRecharge()">N·∫†P</button>
            <button class="btn" style="background: #9c27b0; color: white; padding: 5px 10px; font-size: 12px; margin-left: 5px; box-shadow: 0 0 10px #9c27b0;" onclick="moModalCode()">
    <i class="fas fa-gift"></i> CODE
</button>
            <i class="fas fa-sign-out-alt" style="cursor:pointer; color: #666;" onclick="logout()"></i>
        </div>
    </div>
</nav>

<div class="container">
   <div class="banner" style="text-align: center; padding: 100px 0; background: linear-gradient(rgba(0,0,0,0.8), rgba(0,0,0,0.8)), url('https://i.postimg.cc/g2bY136T/Website-1024x538.png') center/cover; border-radius: 20px; margin-top: 20px; border: 1px solid #444; position: relative; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.5);">
    <h1 class="glow-text" style="font-size: 65px; margin: 0; letter-spacing: 4px; font-weight: 900; text-transform: uppercase; line-height: 1.2;">
        HOANGKUN STORE
    </h1>
    
    <div style="width: 120px; height: 4px; background: var(--primary); margin: 25px auto; border-radius: 10px; box-shadow: 0 0 20px var(--primary);"></div>
    
    <p class="sub-text" style="color: #ffffff; font-size: 18px; letter-spacing: 1px; opacity: 0.9; text-shadow: 1px 1px 5px rgba(0,0,0,0.5);">
        <i class="fas fa-check-circle" style="color: var(--primary);"></i> 
        H·ªÜ TH·ªêNG SOURCE CODE T·ª∞ ƒê·ªòNG - UY T√çN - B·∫¢O M·∫¨T
        <i class="fas fa-check-circle" style="color: var(--primary);"></i>
    </p>
</div>

    <div class="container" style="margin-top: 40px;">
    <div style="background: rgba(15, 15, 15, 0.95); border: 1px solid #333; border-radius: 20px; padding: 25px; box-shadow: 0 0 25px rgba(255, 0, 0, 0.15);">
        <h2 style="text-align: center; color: #fff; text-transform: uppercase; letter-spacing: 3px; margin-bottom: 25px; font-weight: 800;">
            <i class="fas fa-trophy" style="color: gold; margin-right: 10px;"></i> 
            TOP 10 ƒê·∫†I GIA N·∫†P NHI·ªÄU
            <i class="fas fa-trophy" style="color: gold; margin-left: 10px;"></i>
        </h2>
        <div class="table-responsive" style="border-radius: 15px; overflow: hidden;">
            <table class="table" style="color: white; margin-bottom: 0;">
                <thead style="background: linear-gradient(90deg, #ff0000, #990000); color: white;">
                    <tr>
                        <th style="text-align: center; width: 80px; border: none;">H·∫†NG</th>
                        <th style="border: none;">KH√ÅCH H√ÄNG</th>
                        <th style="text-align: center; border: none;">S·ªê D∆Ø HI·ªÜN T·∫†I</th>
                    </tr>
                </thead>
                <tbody id="top-nap-body">
                    </tbody>
            </table>
        </div>
    </div>
</div>

    <h2 class="shop-title"><i class="fas fa-fire"></i> S·∫£n ph·∫©m m·ªõi nh·∫•t</h2>
    <div class="grid" id="productGrid"></div>

   <div id="history-section" class="history-box" style="display:none; border: 1px solid var(--primary); margin-top: 30px;">
    <h3 style="color: var(--primary); text-align: center;"><i class="fas fa-shopping-cart"></i> L·ªäCH S·ª¨ GIAO D·ªäCH & KHO CODE</h3>
    <table style="width: 100%; border-collapse: collapse; table-layout: fixed;">
        <thead>
            <tr style="background: #222; color: #fff;">
                <th style="width: 30%; padding: 10px; border: 1px solid #333;">T√™n S·∫£n Ph·∫©m</th>
                <th style="width: 15%; border: 1px solid #333;">Gi√°</th>
                <th style="width: 30%; border: 1px solid #333;">Ng√†y Mua</th>
                <th style="width: 25%; border: 1px solid #333;">Link T·∫£i</th>
            </tr>
        </thead>
        <tbody id="history-body"></tbody>
    </table>
</div>
    
<div id="authModal" class="modal">
    <div class="modal-content">
        <h2 id="authTitle" style="margin-top:0">LOGIN</h2>
        <div class="input-group">
            <label style="font-size: 12px; color: #666;">T√™n t√†i kho·∫£n</label>
            <input type="text" id="userInput" placeholder="G√µ t√™n t√†i kho·∫£n...">
        </div>
        <div class="input-group">
            <label style="font-size: 12px; color: #666;">M·∫≠t kh·∫©u</label>
            <input type="password" id="passInput" placeholder="*******">
        </div>
        <div id="regFields" style="display: none;">
            <div class="input-group">
                <label style="font-size: 12px; color: #666;">X√°c nh·∫≠n m·∫≠t kh·∫©u</label>
                <input type="password" id="confirmInput" placeholder="*******">
            </div>
        </div>
        <button class="btn btn-red" style="width: 100%; margin-top: 10px;" onclick="handleAuth()">X√ÅC NH·∫¨N</button>
        <p class="auth-switch">
            <span id="switchText">Ch∆∞a c√≥ t√†i kho·∫£n?</span> 
            <b onclick="toggleAuth()" style="color:var(--primary); cursor:pointer">B·∫•m v√†o ƒë√¢y</b>
        </p>
        <div style="margin-top: 20px; font-size: 13px; color: #444; cursor: pointer;" onclick="closeModal('authModal')">ƒê√≥ng c·ª≠a s·ªï</div>
    </div>
</div>
<div id="rechargeModal" class="modal" style="display: none;">
    <div class="modal-content" style="max-width: 500px; padding: 0; overflow: hidden; background: #fff; border: none; border-radius: 15px;">
        <div onclick="closeRecharge()" style="position: absolute; top: 10px; right: 15px; cursor: pointer; font-size: 24px; color: #888; font-weight: bold;">&times;</div>
        
        <div style="display: flex; background: #f8f9fa; border-bottom: 1px solid #ddd;">
            <div id="re-tab0" onclick="switchRechargeTab('atm')" style="flex: 1; padding: 15px; cursor: pointer; color: #ff4747; font-weight: bold; border-bottom: 3px solid #ff4747; text-align: center;">N·∫°p ATM</div>
            <div id="re-tab1" onclick="switchRechargeTab('card')" style="flex: 1; padding: 15px; cursor: pointer; color: #555; font-weight: bold; text-align: center;">N·∫°p th·∫ª</div>
            <div id="re-tab2" onclick="switchRechargeTab('top')" style="flex: 1; padding: 15px; cursor: pointer; color: #555; font-weight: bold; text-align: center;">Top n·∫°p</div>
            <div id="re-tab3" onclick="switchRechargeTab('reward')" style="flex: 1; padding: 15px; cursor: pointer; color: #555; font-weight: bold; text-align: center;">Ph·∫ßn th∆∞·ªüng</div>
        </div>

      <div id="con-atm" style="padding: 20px; display: block;">
    
    <div id="step-1-input">
        <div style="background: #e8f0fe; border: 1px dashed #1877f2; padding: 10px; border-radius: 8px; margin-bottom: 15px;">
            <p style="color: #1877f2; font-size: 13px; margin: 0;">
                <i class="fas fa-bolt"></i> <b>N·∫°p t·ª± ƒë·ªông MB Bank:</b><br>
                Nh·∫≠p ƒë√∫ng s·ªë ti·ªÅn c·∫ßn n·∫°p ƒë·ªÉ h·ªá th·ªëng t·ª± ƒë·ªông c·ªông sau 10s.
            </p>
        </div>

        <label style="font-weight: bold; color: #333; display: block; margin-bottom: 5px;">Nh·∫≠p s·ªë ti·ªÅn mu·ªën n·∫°p:</label>
        <input type="number" id="auto-amount" placeholder="V√≠ d·ª•: 10000, 20000..." 
               style="width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 8px; font-size: 16px; margin-bottom: 5px; outline: none;">
        <p style="font-size: 11px; color: #888; margin-bottom: 15px;">* T·ªëi thi·ªÉu 10.000ƒë</p>

        <button onclick="createPaymentQR()" 
                style="width: 100%; padding: 12px; background: #1877f2; color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; text-transform: uppercase;">
            <i class="fas fa-qrcode"></i> T·∫°o M√£ QR N·∫°p Ti·ªÅn
        </button>
    </div>

    <div id="step-2-qr" style="display: none; text-align: center;">
        <div style="background: #fff; padding: 10px; border: 2px solid #1877f2; border-radius: 10px; display: inline-block; box-shadow: 0 5px 15px rgba(0,0,0,0.1); position: relative;">
            <img id="qr-image" src="" alt="QR Code" style="width: 200px; display: block;">
            
            <img src="https://img.mservice.io/momo_app_v2/new_version/img/app/logo-mb-bank.png" 
                 style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 40px; border: 2px solid #fff; border-radius: 50%;">
        </div>
        
        <div style="margin-top: 15px; text-align: left; background: #f9f9f9; padding: 10px; border-radius: 8px; border: 1px solid #eee;">
            <p style="margin: 5px 0;">üè¶ Ng√¢n h√†ng: <b style="color:#1877f2">MB BANK (Qu√¢n ƒê·ªôi)</b></p>
            <p style="margin: 5px 0;">üí≥ S·ªë t√†i kho·∫£n: <b>88812072006888</b></p>
            <p style="margin: 5px 0;">üë§ Ch·ªß TK: <b>NGUYEN VIET HOANG</b></p>
            <p style="margin: 5px 0; border-top: 1px dashed #ccc; padding-top: 5px; margin-top: 5px;">
                üí∞ S·ªë ti·ªÅn: <b id="display-amount" style="color: #00aa00; font-size: 16px;">0ƒë</b>
            </p>
            <p style="margin: 5px 0;">
                üìù N·ªôi dung: <b id="display-memo" style="color: #d9534f; background: #ffeded; padding: 2px 5px;">...</b>
            </p>
        </div>

        <div style="margin-top: 15px;">
            <div style="font-size: 12px; color: #666; margin-bottom: 10px;">
                <i class="fas fa-sync fa-spin"></i> ƒêang ch·ªù ti·ªÅn v·ªÅ (10-30 gi√¢y)...
            </div>
            <button onclick="resetRecharge()" style="background: none; border: none; color: #666; text-decoration: underline; cursor: pointer;">
                ‚Üê Quay l·∫°i nh·∫≠p ti·ªÅn kh√°c
            </button>
        </div>
    </div>
</div>

       <div id="con-card" style="padding: 20px; display: none;">
    
    <div style="background: #fffcf5; border: 1px dashed #f59f00; padding: 10px; border-radius: 8px; margin-bottom: 15px;">
        <p style="color: #f59f00; font-size: 13px; margin: 0;">
            <i class="fas fa-exclamation-triangle"></i> <b>L∆∞u √Ω quan tr·ªçng:</b><br>
            Sai m·ªánh gi√° s·∫Ω b·ªã ph·∫°t <b>-50%</b> ti·ªÅn nh·∫≠n. Vui l√≤ng ki·ªÉm tra k·ªπ.
        </p>
    </div>

   <label style="font-size: 12px; font-weight: bold; color: #555;">Ch·ªçn lo·∫°i th·∫ª:</label>
<div style="display: flex; gap: 10px; margin-bottom: 15px; margin-top: 5px; flex-wrap: wrap;">
    <div class="telco-btn active" onclick="selectTelco(this, 'VIETTEL')" style="flex: 1 0 25%; min-width: 70px; border: 1px solid #ff9900; background: #fffbe6; padding: 10px; border-radius: 8px; cursor: pointer; text-align: center; font-weight: bold; color: #ee0033;">VIETTEL</div>
    
    <div class="telco-btn" onclick="selectTelco(this, 'VINAPHONE')" style="flex: 1 0 25%; min-width: 70px; border: 1px solid #ddd; padding: 10px; border-radius: 8px; cursor: pointer; text-align: center; font-weight: bold; color: #0085cf;">VINA</div>
    
    <div class="telco-btn" onclick="selectTelco(this, 'MOBIFONE')" style="flex: 1 0 25%; min-width: 70px; border: 1px solid #ddd; padding: 10px; border-radius: 8px; cursor: pointer; text-align: center; font-weight: bold; color: #005a8b;">MOBI</div>

    <div class="telco-btn" onclick="selectTelco(this, 'GARENA')" style="flex: 1 0 40%; border: 1px solid #e74c3c; padding: 10px; border-radius: 8px; cursor: pointer; text-align: center; font-weight: bold; color: #c0392b;">GARENA</div>

    <div class="telco-btn" onclick="selectTelco(this, 'ZING')" style="flex: 1 0 40%; border: 1px solid #f39c12; padding: 10px; border-radius: 8px; cursor: pointer; text-align: center; font-weight: bold; color: #d35400;">ZING</div>
</div>

<input type="hidden" id="card-telco" value="VIETTEL"> 

<label style="font-size: 12px; font-weight: bold; color: #555;">Ch·ªçn m·ªánh gi√°:</label>
<select id="card-amount" style="width: 100%; padding: 12px; margin-bottom: 15px; border: 1px solid #ccc; border-radius: 8px; margin-top: 5px; outline: none;">
    <option value="">-- Ch·ªçn ƒë√∫ng m·ªánh gi√° --</option>
    <option value="10000">10.000ƒë</option>
    <option value="20000">20.000ƒë</option>
    <option value="50000">50.000ƒë</option>
    <option value="100000">100.000ƒë</option>
    <option value="200000">200.000ƒë</option>
    <option value="500000">500.000ƒë</option>
</select>

<script>
    function selectTelco(element, value) {
        // X√≥a class active v√† reset style c√°c n√∫t kh√°c
        document.querySelectorAll('.telco-btn').forEach(btn => {
            btn.classList.remove('active');
            btn.style.background = 'transparent';
            btn.style.borderColor = '#ddd';
        });

        // Th√™m active cho n√∫t ƒë∆∞·ª£c ch·ªçn
        element.classList.add('active');
        document.getElementById('card-telco').value = value;
        
        // ƒê·ªïi m√†u n·ªÅn n√∫t ƒë∆∞·ª£c ch·ªçn cho ƒë·∫πp
        element.style.background = '#fffbe6';
        element.style.borderColor = '#ff9900';
    }
</script>

    <div style="display: flex; gap: 10px; margin-bottom: 15px;">
        <div style="flex: 1;">
            <label style="font-size: 12px; font-weight: bold; color: #555;">M√£ th·∫ª (Pin):</label>
            <input type="number" id="card-pin" placeholder="M√£ s·ªë sau l·ªõp b·∫°c" 
                   style="width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 8px; margin-top: 5px; outline: none;">
        </div>
        <div style="flex: 1;">
            <label style="font-size: 12px; font-weight: bold; color: #555;">S·ªë Seri:</label>
            <input type="number" id="card-serial" placeholder="D√£y s·ªë seri" 
                   style="width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 8px; margin-top: 5px; outline: none;">
        </div>
    </div>

<button onclick="sendCardAuto()" 
            style="width: 100%; padding: 14px; background: linear-gradient(90deg, #ff9900, #ffcc00); color: #fff; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; text-transform: uppercase; font-size: 15px;">
        <i class="fas fa-paper-plane"></i> G·ª≠i th·∫ª ngay
    </button>
</div>
        
        <div id="con-top" style="padding: 15px; display: none; max-height: 300px; overflow-y: auto;">
            <table style="width: 100%; border-collapse: collapse; color: #333; font-size: 14px;">
                <thead>
                    <tr style="border-bottom: 2px solid #eee; color: #888;">
                        <th style="padding: 10px; text-align: left;">H·∫°ng</th>
                        <th style="padding: 10px; text-align: left;">Ng∆∞·ªùi d√πng</th>
                        <th style="padding: 10px; text-align: right;">S·ªë ti·ªÅn</th>
                    </tr>
                </thead>
                <tbody id="top-recharge-modal-body"></tbody>
            </table>
        </div>

        <div id="con-reward" style="padding: 20px; display: none; text-align: left;">
            <div style="background: #fff5f5; border-left: 4px solid #ff4747; padding: 15px; border-radius: 8px;">
                <p style="color: #d9534f; font-weight: bold; margin-bottom: 10px; font-size: 16px;">üéÅ ƒêUA TOP N·∫†P TH√ÅNG 02</p>
                <div style="display: flex; flex-direction: column; gap: 8px;">
                    <div style="display: flex; justify-content: space-between; padding: 8px; background: white; border-radius: 5px; border: 1px solid #ffebeb;">
                        <span>ü•á <b>Top 1</b></span>
                        <b style="color: #ff4747;">500.000 VNƒê</b>
                    </div>
                    <div style="display: flex; justify-content: space-between; padding: 8px; background: white; border-radius: 5px; border: 1px solid #ffebeb;">
                        <span>ü•à <b>Top 2</b></span>
                        <b style="color: #ff4747;">200.000 VNƒê</b>
                    </div>
                    <div style="display: flex; justify-content: space-between; padding: 8px; background: white; border-radius: 5px; border: 1px solid #ffebeb;">
                        <span>ü•â <b>Top 3</b></span>
                        <b style="color: #ff4747;">100.000 VNƒê</b>
                    </div>
                </div>
                <p style="font-size: 11px; color: #888; margin-top: 10px; font-style: italic;">* Ph·∫ßn th∆∞·ªüng c·ªông v√†o t√†i kho·∫£n cu·ªëi th√°ng</p>
            </div>
        </div>

        <div id="con-history" style="padding: 10px; display: none; max-height: 350px; overflow-y: auto;">
    <table style="width: 100%; border-collapse: collapse; font-size: 13px;">
        <thead>
            <tr style="background: #f8f9fa; color: #555; border-bottom: 2px solid #ddd;">
                <th style="padding: 10px; text-align: left;">Th·ªùi gian</th>
                <th style="padding: 10px; text-align: left;">Lo·∫°i</th>
                <th style="padding: 10px; text-align: right;">S·ªë ti·ªÅn</th>
                <th style="padding: 10px; text-align: center;">Tr·∫°ng th√°i</th>
            </tr>
        </thead>
        <tbody id="deposit-history-body">
            <tr><td colspan="4" style="text-align:center; padding:20px; color:#999;">ƒêang t·∫£i d·ªØ li·ªáu...</td></tr>
        </tbody>
    </table>

        <div style="padding: 15px; border-top: 1px solid #eee;">
            <button onclick="document.getElementById('rechargeModal').style.display='none'" style="width: 100%; padding: 14px; border: none; border-radius: 12px; background: #666; color: #fff; cursor: pointer; font-weight: bold;">ƒê√ìNG</button>
        </div>
    </div> </div> </div>

    <script>

        function closeRecharge() {
    const modal = document.getElementById('rechargeModal');
    if (modal) {
        modal.style.display = 'none';
    }
}

        function loadTopRechargeModal() {
    const topBody = document.getElementById('top-recharge-modal-body');
    if (!topBody) return;

    // L·∫•y danh s√°ch user, s·∫Øp x·∫øp theo balance ho·∫∑c m·ªôt tr∆∞·ªùng 'total_n·∫°p' n·∫øu b·∫°n c√≥
    db.ref('users').orderByChild('balance').limitToLast(10).on('value', snapshot => {
        let html = '';
        let rank = 1;
        let users = [];

        snapshot.forEach(child => {
            users.push(child.val());
        });
        
        // ƒê·∫£o ng∆∞·ª£c danh s√°ch ƒë·ªÉ ng∆∞·ªùi cao nh·∫•t l√™n ƒë·∫ßu
        users.reverse().forEach(user => {
            let color = rank <= 3 ? '#ff4747' : '#555'; // Top 3 ƒë·ªÉ m√†u ƒë·ªè cho n·ªïi
            html += `
                <tr style="border-bottom: 1px solid #f9f9f9;">
                    <td style="padding: 10px; font-weight: bold; color: ${color};">#${rank}</td>
                    <td style="padding: 10px;">${user.username || user.name || 'Kh√°ch'}</td>
                    <td style="padding: 10px; text-align: right; font-weight: bold; color: #28a745;">
                        ${(user.balance || 0).toLocaleString()}ƒë
                    </td>
                </tr>
            `;
            rank++;
        });
        topBody.innerHTML = html;
    });
}

    let isSpinning = false; // Th√™m d√≤ng n√†y ·ªü ƒë·∫ßu file Script
    
    // --- 1. K·∫æT N·ªêI FIREBASE ---
    const firebaseConfig = {
        apiKey: "AIzaSyDqpk71mVDWCP3jk7fxbHZayz92LTheY7g",
        databaseURL: "https://hoangkun-594d0-default-rtdb.firebaseio.com",
    };
    if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
        

     // --- 1. H√†m chuy·ªÉn Tab n·∫°p ti·ªÅn ---
function switchRechargeTab(tab) {
    const tabs = ['card', 'top', 'reward'];
    tabs.forEach(t => {
        const content = document.getElementById('con-' + t);
        const btn = document.getElementById('re-tab' + (tabs.indexOf(t) + 1));
        if(content) content.style.display = (t === tab) ? 'block' : 'none';
        if (btn) {
            btn.style.color = (t === tab) ? '#ff4747' : '#555';
            btn.style.borderBottom = (t === tab) ? '3px solid #ff4747' : 'none';
        }
   }); // K·∫øt th√∫c tabs.forEach

    if (tab === 'top') {
        loadTopRechargeModal();
    }
} // K·∫øt th√∫c h√†m switchRechargeTab t·∫°i ƒë√¢y (D√≤ng 482)

function showRecharge() {
    const user = localStorage.getItem('hoangUser');
    if (!user) return showAuth(false);
    
    document.getElementById('rechargeModal').style.display = 'flex';
    switchRechargeTab('atm'); 

    // T·ª± ƒë·ªông ƒëi·ªÅn n·ªôi dung: nap + t√™n t√†i kho·∫£n
    const memoElement = document.getElementById('nap-memo');
    if (memoElement) {
        memoElement.innerText = `nap ${user}`;
    }
}
        
function sendCard() {
    const user = localStorage.getItem('hoangUser');
    const type = document.getElementById('cardType').value;
    const value = document.getElementById('cardValue').value;
    const seri = document.getElementById('cardSeri').value.trim();
    const pin = document.getElementById('cardPin').value.trim();
    
    if(!type || !value || !seri || !pin) {
        return Swal.fire("L·ªói", "Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin th·∫ª!", "error");
    }

    // Hi·ªáu ·ª©ng "ƒêang g·ª≠i" cho x·ªãn
    Swal.fire({
        title: 'ƒêang g·ª≠i th·∫ª...',
        didOpen: () => { Swal.showLoading(); }
    });

    // L∆∞u th√¥ng tin th·∫ª v√†o nh√°nh 'card_requests' tr√™n Firebase
    db.ref('card_requests').push({
        username: user,
        cardType: type,
        cardValue: value,
        seri: seri,
        pin: pin,
        status: "pending",
        time: new Date().toLocaleString()
    }).then(() => {
        Swal.fire("Th√†nh c√¥ng", "Th·∫ª ƒë√£ ƒë∆∞·ª£c g·ª≠i! Ch·ªù Admin duy·ªát nh√©.", "success");
        closeModal('rechargeModal');
        // X√≥a tr·∫Øng √¥ nh·∫≠p ƒë·ªÉ l·∫ßn sau n·∫°p ti·∫øp
        document.getElementById('cardSeri').value = '';
        document.getElementById('cardPin').value = '';
    }).catch(err => Swal.fire("L·ªói", err.message, "error"));
}
    

   // Thay th·∫ø ƒëo·∫°n c≈© b·∫±ng ƒëo·∫°n n√†y:
const products = [
    { id: 1, name: "CODE TRAITYM 1", price: 22000, img: "https://cellphones.com.vn/sforum/wp-content/uploads/2024/03/Huong-dan-tao-code-trai-tim-html-tang-nguoi-than-yeu-nhan-ngay-8-3-3.jpg", link: "https://www.mediafire.com/file/x82cfpep8576y2m/Code_tr%25C3%25A1i_tym_1.zip/file" },
    { id: 2, name: "CODE TRAITYM 2", price: 28000, img: "https://cellphones.com.vn/sforum/wp-content/uploads/2024/03/Huong-dan-tao-code-trai-tim-html-tang-nguoi-than-yeu-nhan-ngay-8-3-9.jpg", link: "https://www.mediafire.com/file/9ouog8a5ot8bbjr/Code_tr%25C3%25A1i_tym_2.zip/file" },
    { id: 3, name: "CODE TRAITYM 3", price: 32000, img: "https://cellphones.com.vn/sforum/wp-content/uploads/2024/03/Huong-dan-tao-code-trai-tim-html-tang-nguoi-than-yeu-nhan-ngay-8-3-13.jpg", link: "https://www.mediafire.com/file/y5koz065nphas87/Code_tr%25C3%25A1i_tym_3.zip/file" },
    { id: 4, name: "CODE WEB SHOP", price: 350000, img: "https://i.postimg.cc/JzmdcN7p/game-title.jpg", link: "https://www.mediafire.com/file/kpd7vqbm7235b46/Code+website+Game.zip/file" },
    { id: 5, name: "CODE GAME B·∫ÆN CUNG", price: 60000, img: "https://i.postimg.cc/svBYRYkr/IMG-6222.png", link: "https://www.mediafire.com/file/fppnwb0cye4f8p7/Code_ba%25CC%2586%25CC%2581n_cung.zip/file" },
    { id: 6, name: "CODE WEB M√àO CUTE", price: 75000, img: "https://i.postimg.cc/QKFThDy3/IMG-6223.gif", link: "https://www.mediafire.com/file/tcobfv1lccqrvjb/Code_chu%25CC%2581c_mu%25CC%259B%25CC%2580ng_sinh_nha%25CC%25A3%25CC%2582t_1.zip/file" },
    { id: 7, name: "CODE HI·ªÜU ·ª®NG R·ªíNG", price: 69000, img: "https://i.postimg.cc/Czfq2F8R/IMG-6224.gif", link: "https://www.mediafire.com/file/csvufyf40lrz37s/Code_hie%25CC%25A3%25CC%2582u_u%25CC%259B%25CC%2581ng_tro%25CC%2589_chuo%25CC%25A3%25CC%2582t_1.zip/file" },
    { id: 8, name: "CODE HI·ªÜU ·ª®NG CHU·ªòT 2", price: 65000, img: "https://i.postimg.cc/K3mMVW6Q/IMG-6225.gif", link: "https://www.mediafire.com/file/rzwparz9rv49icq/Code_Hie%25CC%25A3%25CC%2582u_U%25CC%259B%25CC%2581ng_Chuo%25CC%25A3%25CC%2582t_2.zip/file" },
    { id: 10, name: "Code Th∆∞ T·ªè T√¨nh", price: 50000, img: "https://i.postimg.cc/q62Czw4K/IMG-6227.gif", link: "https://www.mediafire.com/file/689n10vjdpsnnfv/Code_Thu%25CC%259B_To%25CC%2589_Ti%25CC%2580nh.zip/file" },
    { id: 11, name: "Code Thi·ªáp Ch√∫c Gi√°ng Sinh", price: 51000, img: "https://i.postimg.cc/3yHJnG5Y/IMG-6228.png", link: "https://www.mediafire.com/file/t914seytwtw0me0/Code_Thu%25CC%259B_Gia%25CC%2581ng_Sinh.zip/file" },
    { id: 12, name: "CODE HI·ªÜU ·ª®NG CHU·ªòT 4", price: 63000, img: "https://i.postimg.cc/NKjWYf6d/IMG-6231.gif", link: "https://www.mediafire.com/file/e064bjd9uyb8z75/Code_Hie%25CC%25A3%25CC%2582u_U%25CC%259B%25CC%2581ng_Chuo%25CC%25A3%25CC%2582t_4.zip/file" },
    { id: 13, name: "CODE HI·ªÜU ·ª®NG CHU·ªòT 5", price: 58000, img: "https://i.postimg.cc/HrkfHswf/IMG-6232.gif", link: "https://www.mediafire.com/file/6zwm6ew9ygnr1u3/Code_Hie%25CC%25A3%25CC%2582u_U%25CC%259B%25CC%2581ng_Chuo%25CC%25A3%25CC%2582t_5.zip/file" },
    { id: 14, name: "CODE HI·ªÜU ·ª®NG LOADDING", price: 21000, img: "https://i.postimg.cc/pmLgxXfS/IMG-6233.png", link: "https://www.mediafire.com/file/zgsje7jjri4wh7t/Code_Hie%25CC%25A3%25CC%2582u_U%25CC%259B%25CC%2581ng_Loadding.zip/file" },
    { id: 15, name: "Code Qly Web Tr∆∞·ªùng H·ªçc", price: 220000, img: "https://i.postimg.cc/G3B9xytZ/Untitled.png", link: "https://www.mediafire.com/file/xd5x96ia1g6arbv/Code+website+qu·∫£n+l√Ω+tr∆∞·ªùng+h·ªçc.zip/file" },
    { id: 16, name: "CODE WEBSITE ", price: 200000, img: "https://i.postimg.cc/DzqnVxw3/Untitled.png", link: "https://www.mediafire.com/file/g65sp328f6xfwvl/Code+website.zip/file" }
];
    function renderProducts() {
        document.getElementById('productGrid').innerHTML = products.map(p => `
            <div class="card">
                <div class="thumb"><img src="${p.img}"></div>
                <div class="card-body">
                    <h3 style="font-size:16px; margin:0;">${p.name}</h3>
                    <div class="price">${p.price.toLocaleString()}ƒë</div>
                    <button class="btn btn-red" style="width:100%" onclick="buyItem('${p.name}', ${p.price}, '${p.link}')">MUA NGAY</button>
                </div>
            </div>
        `).join('');
    }

    // --- 3. LOGIC T√ÄI KHO·∫¢N (ƒê√É FIX L·ªñI) ---
    let isRegisterMode = false;

    function showAuth(isReg) {
        isRegisterMode = isReg;
        updateAuthUI();
        document.getElementById('authModal').style.display = 'flex';
    }

    function toggleAuth() {
        isRegisterMode = !isRegisterMode;
        updateAuthUI();
    }

    function updateAuthUI() {
        document.getElementById('authTitle').innerText = isRegisterMode ? "ƒêƒÇNG K√ù" : "ƒêƒÇNG NH·∫¨P";
        document.getElementById('regFields').style.display = isRegisterMode ? "block" : "none";
        document.getElementById('switchText').innerText = isRegisterMode ? "ƒê√£ c√≥ t√†i kho·∫£n?" : "Ch∆∞a c√≥ t√†i kho·∫£n?";
    }

    function handleAuth() {
        const user = document.getElementById('userInput').value.trim().toLowerCase();
        const pass = document.getElementById('passInput').value;

        if(!user || !pass) return Swal.fire("L·ªói", "Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß!", "error");

        if(isRegisterMode) {
            const confirm = document.getElementById('confirmInput').value;
            if(pass !== confirm) return Swal.fire("L·ªói", "M·∫≠t kh·∫©u kh√¥ng kh·ªõp!", "error");

            db.ref('users/' + user).once('value').then(snap => {
                if(snap.exists()) {
                    Swal.fire("L·ªói", "T√™n t√†i kho·∫£n ƒë√£ t·ªìn t·∫°i!", "error");
                } else {
                    db.ref('users/' + user).set({
                        pass: pass,
                        balance: 0,
                        createdAt: new Date().toLocaleString()
                    }).then(() => {
                        Swal.fire("Th√†nh c√¥ng", "ƒêƒÉng k√Ω th√†nh c√¥ng! H√£y ƒëƒÉng nh·∫≠p.", "success");
                        isRegisterMode = false;
                        updateAuthUI();
                    });
                }
            });
        } else {
            db.ref('users/' + user).once('value').then(snap => {
                const data = snap.val();
                if(data && data.pass === pass) {
                    localStorage.setItem('hoangUser', user);
                    Swal.fire("Ch√†o m·ª´ng", "ƒêƒÉng nh·∫≠p th√†nh c√¥ng!", "success").then(() => location.reload());
                } else {
                    Swal.fire("L·ªói", "Sai t√†i kho·∫£n ho·∫∑c m·∫≠t kh·∫©u!", "error");
                }
            });
        }
    }

       function checkLogin() {
    const user = localStorage.getItem('hoangUser');
    const userSection = document.getElementById('user-section');
    const authSection = document.getElementById('auth-section');

    if(user && userSection) {
        authSection.style.display = 'none';
        userSection.style.display = 'flex';
        document.getElementById('history-section').style.display = 'block';
        
        // ƒêo·∫°n n√†y ƒë√£ b·ªè n√∫t Trang c√° nh√¢n l·ªói
        userSection.innerHTML = `
            <span style="color: #fff; margin-right: 10px;">Ch√†o, <b style="color:var(--primary)">${user}</b></span>
            <div style="background: #222; padding: 5px 12px; border-radius: 20px; font-size: 14px; margin-right: 10px;">
                <i class="fas fa-wallet" style="color:#00ff00"></i> <span id="user-balance">0ƒë</span>
            </div>
            <button class="btn btn-red" style="padding: 5px 10px; font-size: 12px;" onclick="showRecharge()">N·∫†P</button>
            <a href="profile.html" class="btn" style="background: #333; color: white; padding: 5px 10px; font-size: 12px; text-decoration: none; margin-left: 5px;">
    <i class="fas fa-user"></i> H·ªí S∆†
</a>
            <i class="fas fa-sign-out-alt" style="cursor:pointer; color: #666; margin-left:10px" onclick="logout()"></i>
        `;
        
        db.ref('users/' + user).on('value', snap => {
            const data = snap.val();
            if(data) {
                const balance = data.balance || 0;
                localStorage.setItem('hoangBal', balance);
                const balEl = document.getElementById('user-balance');
                if(balEl) balEl.innerText = balance.toLocaleString() + 'ƒë';
            }
        });
        loadHistory(user);
    }
}

   function buyItem(name, price, downloadLink) {
    const user = localStorage.getItem('hoangUser');
    if(!user) return showAuth(false);

    const currentBal = parseInt(localStorage.getItem('hoangBal') || 0);
    if(currentBal < price) {
        Swal.fire("Thi·∫øu ti·ªÅn", "S·ªë d∆∞ kh√¥ng ƒë·ªß!", "warning").then(() => showRecharge());
        return;
    }

    Swal.fire({
        title: 'X√°c nh·∫≠n mua?',
        text: `Mua ${name} v·ªõi gi√° ${price.toLocaleString()}ƒë?`,
        icon: 'question',
        showCancelButton: true,
        confirmButtonColor: '#ff0000',
        confirmButtonText: 'MUA NGAY'
    }).then((result) => {
        if (result.isConfirmed) {
            const newBal = currentBal - price;
            const now = new Date().toLocaleString();

            // Ch·ªâ l∆∞u v√†o 1 b·∫£ng duy nh·∫•t l√† 'history' nh∆∞ng c√≥ th√™m link
            db.ref('history/' + user).push({
                product: name,
                price: price,
                date: now,
                link: downloadLink, // L∆∞u link v√†o ƒë√¢y lu√¥n
                status: "Th√†nh c√¥ng"
            });

// T·∫∂NG L∆Ø·ª¢T QUAY: C·ª© m·ªói 50.000ƒë gi√° tr·ªã m√≥n h√†ng ƒë∆∞·ª£c 1 l∆∞·ª£t
            let bonusSpins = Math.floor(price / 50000); 

            if (bonusSpins > 0) {
                db.ref('users/' + user).once('value').then(snapshot => {
                    let userData = snapshot.val() || {};
                    let currentFreeSpins = userData.freeSpins || 0;
                    
                    db.ref('users/' + user).update({
                        balance: newBal,
                        freeSpins: currentFreeSpins + bonusSpins
                    });
                    
                    Swal.fire("Th√†nh c√¥ng", `B·∫°n ƒë√£ mua ${name} v√† ƒë∆∞·ª£c t·∫∑ng ${bonusSpins} l∆∞·ª£t quay!`, "success");
                });
            } else {
                db.ref('users/' + user).update({ balance: newBal });
                Swal.fire("Th√†nh c√¥ng", `B·∫°n ƒë√£ mua ${name} th√†nh c√¥ng!`, "success");
            }
        } // K·∫øt th√∫c if (result.isConfirmed)
    }); // K·∫øt th√∫c .then c·ªßa Swal
} // K·∫øt th√∫c function buyItem
            
  function loadHistory(user) {
    db.ref('history/' + user).on('value', snap => {
        const historyBody = document.getElementById('history-body');
        const data = snap.val();
        if(!data) {
            historyBody.innerHTML = '<tr><td colspan="4" style="text-align:center">Ch∆∞a c√≥ giao d·ªãch n√†o</td></tr>';
            return;
        }

        let html = '';
        for(let id in data) {
            html = `<tr>
                <td style="color:#fff; padding: 10px; border: 1px solid #333;">${data[id].product}</td>
                <td style="color:var(--primary); border: 1px solid #333;">${(data[id].price || 0).toLocaleString()}ƒë</td>
                <td style="color:#ccc; font-size: 13px; border: 1px solid #333;">${data[id].date}</td>
                <td style="text-align: center; border: 1px solid #333;">
                    <a href="${data[id].link || '#'}" target="_blank" 
                       style="color:#00ff00; text-decoration:none; font-weight:bold; border:1px solid #00ff00; padding:3px 8px; border-radius:4px; font-size:12px;">
                       <i class="fas fa-download"></i> T·∫¢I V·ªÄ
                    </a>
                </td>
            </tr>` + html;
        }
        historyBody.innerHTML = html;
    });
}

  function logout() {
    localStorage.removeItem('hoangUser');
    Swal.fire("Th√¥ng b√°o", "ƒê√£ ƒëƒÉng xu·∫•t th√†nh c√¥ng!", "success").then(() => {
        location.reload(); // T·∫£i l·∫°i trang ƒë·ªÉ c·∫≠p nh·∫≠t giao di·ªán
    });
}
        
    // --- 5. HI·ªÜU ·ª®NG V√Ä TRANG TR√ç ---
    function initParticles() {
        const canvas = document.getElementById('particleCanvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth; canvas.height = window.innerHeight;
        let particles = [];
        for(let i=0; i<60; i++) {
            particles.push({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                vx: Math.random() - 0.5,
                vy: Math.random() - 0.5
            });
        }
        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = "rgba(255, 0, 0, 0.2)";
            particles.forEach(p => {
                p.x += p.vx; p.y += p.vy;
                if(p.x < 0 || p.x > canvas.width) p.vx *= -1;
                if(p.y < 0 || p.y > canvas.height) p.vy *= -1;
                ctx.beginPath(); ctx.arc(p.x, p.y, 2, 0, Math.PI*2); ctx.fill();
            });
            requestAnimationFrame(animate);
        }
        animate();
    }

    function startFakeNoti() {
        const names = ["Qu·ªëc B·∫£o", "VƒÉn Nam", "Thanh T√πng", "Minh H·∫±ng", "ƒê·ª©c Huy"];
        const prices = ["50,000ƒë", "200,000ƒë", "100,000ƒë", "500,000ƒë"];
        setInterval(() => {
            const noti = document.getElementById('fakeNoti');
            document.getElementById('fakeNotiText').innerHTML = `Kh√°ch h√†ng <b>${names[Math.floor(Math.random()*names.length)]}</b> v·ª´a n·∫°p th√†nh c√¥ng ${prices[Math.floor(Math.random()*prices.length)]}`;
            noti.classList.add('show');
            setTimeout(() => noti.classList.remove('show'), 5000);
        }, 12000);
    }

    window.onload = () => {
        initParticles();
        renderProducts();
        checkLogin();
        startFakeNoti();
    };
</script>

    <script>
    const canvas = document.getElementById('particleCanvas');
    if(canvas) {
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        let particles = [];
        for(let i=0; i<100; i++) {
            particles.push({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                size: Math.random() * 2 + 1,
                speedY: Math.random() * 1 + 0.5
            });
        }
        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = 'rgba(255, 0, 0, 0.5)';
            particles.forEach(p => {
                p.y -= p.speedY;
                if(p.y < 0) p.y = canvas.height;
                ctx.beginPath();
                ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
                ctx.fill();
            });
            requestAnimationFrame(animate);
        }
        animate();
    }

        function loadBoughtCodes(user) {
    db.ref('bought_codes/' + user).on('value', snap => {
        const data = snap.val();
        const body = document.getElementById('kho-code-body');
        if (!data) return;

        let html = '';
        for (let id in data) {
            html = `<tr>
                <td>${data[id].name}</td>
                <td>${data[id].date}</td>
                <td><a href="${data[id].link}" target="_blank" style="color:#00ff00; text-decoration:none; font-weight:bold;">[T·∫¢I V·ªÄ]</a></td>
            </tr>` + html;
        }
        body.innerHTML = html;
    });
}

        function loadTopTen() {
    db.ref('users').on('value', snap => {
        const users = snap.val();
        if (!users) return;

        let userArray = [];
        for (let username in users) {
            userArray.push({
                name: username,
                balance: users[username].balance || 0
            });
        }

        // S·∫Øp x·∫øp ai nhi·ªÅu ti·ªÅn h∆°n ƒë·ª©ng tr∆∞·ªõc
        userArray.sort((a, b) => b.balance - a.balance);

        const top10 = userArray.slice(0, 10);
        let html = '';

        top10.forEach((user, index) => {
            let rank = index + 1;
            let icon = rank;
            let nameColor = "#eee";

            if (index === 0) { icon = 'üëë'; nameColor = "gold"; }
            else if (index === 1) { icon = 'ü•à'; nameColor = "silver"; }
            else if (index === 2) { icon = 'ü•â'; nameColor = "#cd7f32"; }

            html += `
                <tr style="border-bottom: 1px solid #222; background: rgba(255,255,255,0.03);">
                    <td style="text-align: center; font-weight: bold; padding: 12px;">${icon}</td>
                    <td style="font-weight: 600; color: ${nameColor}; padding: 12px;">${user.name}</td>
                    <td style="text-align: center; color: #00ff00; font-weight: bold; padding: 12px;">
                        ${user.balance.toLocaleString()}ƒë
                    </td>
                </tr>
            `;
        });
        document.getElementById('top-nap-body').innerHTML = html;
    });
}
// Ch·∫°y h√†m
loadTopTen();

function openProfile() {
    const user = localStorage.getItem('hoangUser');
    if (!user) return typeof showAuth === 'function' ? showAuth(false) : alert("Vui l√≤ng ƒëƒÉng nh·∫≠p!");

    // 1. ·∫®n t·∫•t c·∫£ n·ªôi dung ch√≠nh c·ªßa shop ƒë·ªÉ hi·ªán trang c√° nh√¢n
    const mainElements = document.querySelectorAll('section, .container-fluid, #main-content, .banner, .shop-title, .grid');
    mainElements.forEach(el => el.style.display = 'none');

    // 2. Hi·ªán khung profile-page
    const profilePage = document.getElementById('profile-page');
    if (profilePage) {
        profilePage.style.display = 'block';
    } else {
        return console.error("Kh√¥ng t√¨m th·∫•y ID 'profile-page' trong HTML!");
    }

    // 3. Hi·ªÉn th·ªã t√™n (h·ªó tr·ª£ c·∫£ th·∫ª input v√† th·∫ª text)
    const pInput = document.getElementById('p-username');
    const pDisplay = document.getElementById('p-username-display');
    if (pInput) pInput.value = user;
    if (pDisplay) pDisplay.innerText = user;

    // 4. Load l·ªãch s·ª≠ t·ª´ Firebase
    db.ref('wallet_history/' + user).limitToLast(20).on('value', snap => {
        const body = document.getElementById('wallet-history-body');
        if (!body) return;
        
        body.innerHTML = '';
        const data = snap.val();
        
        if (!data) {
            body.innerHTML = '<tr><td colspan="5" style="text-align:center; padding:20px; color:#888;">Kh√¥ng c√≥ d·ªØ li·ªáu l·ªãch s·ª≠</td></tr>';
            return;
        }

        Object.values(data).reverse().forEach(item => {
            const amountColor = item.amount > 0 ? '#00ff00' : '#ff4444';
            const amountPrefix = item.amount > 0 ? '+' : '';
            
            body.innerHTML += `
                <tr style="border-bottom: 1px solid #333;">
                    <td style="padding: 12px; font-size:12px;">${item.date || '---'}</td>
                    <td style="padding: 12px; color:${amountColor}; font-weight:bold;">${amountPrefix}${(item.amount || 0).toLocaleString()}ƒë</td>
                    <td style="padding: 12px; color:#aaa;">${(item.balanceBefore || 0).toLocaleString()}ƒë</td>
                    <td style="padding: 12px; color:#fff;">${(item.balanceAfter || 0).toLocaleString()}ƒë</td>
                    <td style="padding: 12px;"><span style="background:#333; padding:2px 8px; border-radius:10px; font-size:11px;">${item.note || 'Giao d·ªãch'}</span></td>
                </tr>`;
        });
    });
}

function closeProfile() {
    // C√°ch an to√†n nh·∫•t: Reload trang ƒë·ªÉ giao di·ªán shop quay v·ªÅ tr·∫°ng th√°i ban ƒë·∫ßu
    location.reload(); 
}
        
</script>

<div class="contact-sidebar">
    <a href="https://zalo.me/84788265513" target="_blank" class="contact-item zalo">
        <i class="fa-solid fa-comment"></i>
    </a>
    
    <a href="https://facebook.com/nvh12072006" target="_blank" class="contact-item facebook">
        <i class="fa-brands fa-facebook-f"></i>
    </a>

    <a href="https://t.me/@kunmmo2006" target="_blank" class="contact-item telegram">
        <i class="fa-brands fa-telegram"></i>
    </a>
</div>

    <div id="profile-page" style="display: none; background: #f4f6f9; min-height: 100vh; padding: 20px 0;">
    <div class="container" style="max-width: 1100px;">
        <nav style="margin-bottom: 20px; font-size: 14px;">
            <a href="#" onclick="closeProfile()" style="text-decoration:none; color:#333;">Trang ch·ªß</a> 
            <span style="color:#999;"> &gt; L·ªãch s·ª≠ giao d·ªãch</span>
        </nav>

        <div style="background: #fff; padding: 25px; border-radius: 5px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); margin-bottom: 20px;">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div>
                    <label style="display:block; margin-bottom:5px; font-weight:bold;">T√™n c·ªßa b·∫°n <span style="color:red">*</span></label>
                    <input type="text" id="p-username" disabled style="width:100%; padding:10px; border:1px solid #ddd; background:#f9f9f9;">
                </div>
                <div>
                    <label style="display:block; margin-bottom:5px; font-weight:bold;">S·ªë ƒëi·ªán tho·∫°i</label>
                    <input type="text" placeholder="Ch∆∞a c·∫≠p nh·∫≠t" style="width:100%; padding:10px; border:1px solid #ddd;">
                </div>
            </div>
            <div style="margin-top:15px;">
                <label style="display:block; margin-bottom:5px; font-weight:bold;">M·∫≠t kh·∫©u m·ªõi</label>
                <input type="password" id="p-new-pass" placeholder="B·ªè tr·ªëng n·∫øu gi·ªØ m·∫≠t kh·∫©u c≈©" style="width:100%; padding:10px; border:1px solid #ddd;">
            </div>
            <button class="btn" style="background:#d9534f; color:#fff; margin-top:20px; border:none; padding:10px 25px; border-radius:3px;">
                <i class="fas fa-edit"></i> C·∫≠p nh·∫≠t
            </button>
        </div>

        <div style="background: #fff; padding: 20px; border-radius: 5px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
            <h4 style="color: #d9534f; margin-bottom: 20px;"><i class="fas fa-file-invoice-dollar"></i> L·ªãch s·ª≠ bi·∫øn ƒë·ªông s·ªë d∆∞</h4>
            <div style="overflow-x: auto;">
                <table style="width: 100%; border-collapse: collapse; font-size: 14px;">
                    <thead>
                        <tr style="background: #f8f9fa; border-bottom: 2px solid #dee2e6;">
                            <th style="padding: 12px; text-align: left;">Th·ªùi gian</th>
                            <th style="padding: 12px; text-align: left;">S·ªë ti·ªÅn</th>
                            <th style="padding: 12px; text-align: left;">S·ªë d∆∞ tr∆∞·ªõc</th>
                            <th style="padding: 12px; text-align: left;">S·ªë d∆∞ sau</th>
                            <th style="padding: 12px; text-align: left;">Lo·∫°i</th>
                        </tr>
                    </thead>
                    <tbody id="wallet-history-body">
                        <tr><td colspan="5" style="text-align:center; padding:20px; color:#999;">Kh√¥ng c√≥ d·ªØ li·ªáu</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

    <footer style="background: #0a0a0a; border-top: 2px solid var(--primary); padding: 50px 0 20px; margin-top: 50px;">
    <div class="container">
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 40px;">
            
            <div>
                <a href="#" class="logo" style="text-decoration: none;">HOANGKUN<span>STORE</span></a>
                <p style="color: #888; font-size: 14px; line-height: 1.6; margin-top: 15px;">
                    Chuy√™n cung c·∫•p c√°c gi·∫£i ph√°p Source Code Website, hi·ªáu ·ª©ng HTML/CSS ch·∫•t l∆∞·ª£ng cao. H·ªá th·ªëng thanh to√°n t·ª± ƒë·ªông, an to√†n v√† b·∫£o m·∫≠t.
                </p>

                <div class="popup-body" style="text-align: center; padding: 30px 20px;">
    <a href="https://zalo.me/84788265513" target="_blank" class="zalo-blink-btn">
        <i class="fas fa-headset"></i> CHƒÇM S√ìC KH√ÅCH H√ÄNG
    </a>
</div>

<style>
    /* CSS N√∫t b·∫•m & Hi·ªáu ·ª©ng */
    .zalo-blink-btn {
        display: inline-block;
        background: #d32f2f; /* M√†u ƒë·ªè */
        color: #fff;
        font-weight: 900;
        text-decoration: none;
        padding: 12px 25px; /* CƒÉn ch·ªânh l·∫°i cho n√∫t to ƒë·∫πp */
        border-radius: 5px;
        font-size: 1.1rem;
        text-transform: uppercase;
        border: 2px solid #ff5252;
        animation: pulse-red 1.5s infinite; /* Hi·ªáu ·ª©ng nh·ªãp tim */
        transition: 0.3s;
        cursor: pointer;
    }

    /* Hi·ªáu ·ª©ng khi di chu·ªôt v√†o */
    .zalo-blink-btn:hover {
        background: #fff;
        color: #d32f2f;
        transform: scale(1.05);
        box-shadow: 0 0 20px #d32f2f;
    }

    /* Animation nh·∫•p nh√°y */
    @keyframes pulse-red {
        0% { box-shadow: 0 0 0 0 rgba(255, 82, 82, 0.7); }
        70% { box-shadow: 0 0 0 15px rgba(255, 82, 82, 0); }
        100% { box-shadow: 0 0 0 0 rgba(255, 82, 82, 0); }
    }
</style>
                
            </div>

            <div>
                <h4 style="color: var(--primary); text-transform: uppercase; margin-bottom: 20px;">Li√™n k·∫øt nhanh</h4>
                <ul style="list-style: none; padding: 0; font-size: 14px; line-height: 2;">
                    <li><a href="#" style="color: #ccc; text-decoration: none;">Trang ch·ªß</a></li>
                   <li><a href="javascript:void(0);" onclick="moModalCode()" style="color: #ccc; text-decoration: none;"><i class="fas fa-ticket-alt" style="color: var(--primary);"></i> Nh·∫≠p m√£ Giftcode</a></li>
                    <li><a href="https://zalo.me/84788265513" target="_blank" style="color: #ccc; text-decoration: none;">H·ªó tr·ª£ kh√°ch h√†ng</a></li>
                    <li><a href="#" onclick="showRecharge()" style="color: #ccc; text-decoration: none;">H∆∞·ªõng d·∫´n n·∫°p ti·ªÅn</a></li>
                </ul>
            </div>

            <div>
                <h4 style="color: var(--primary); text-transform: uppercase; margin-bottom: 20px;">Th√¥ng tin li√™n h·ªá</h4>
                <div style="font-size: 14px; color: #ccc; display: flex; flex-direction: column; gap: 12px;">
                    <div><i class="fas fa-phone-alt" style="color: var(--primary); width: 20px;"></i> Hotline: 0788.265.513</div>
                    <div><i class="fas fa-envelope" style="color: var(--primary); width: 20px;"></i> Email: hoangvb12072006@gmail.com</div>
                    <div><i class="fas fa-map-marker-alt" style="color: var(--primary); width: 20px;"></i> ƒê·ªãa ch·ªâ: H·∫£i Ph√≤ng, Vi·ªát Nam</div>
                    <div style="margin-top: 10px; display: flex; gap: 15px;">
                        <a href="https://facebook.com/nvh12072006" target="_blank" style="color: #fff; font-size: 20px;"><i class="fab fa-facebook-square"></i></a>
                        <a href="https://zalo.me/84788265513" target="_blank" style="color: #fff; font-size: 20px;"><i class="fas fa-comment-dots"></i></a>
                        <a href="https://t.me/@kunmmo2006" target="_blank" style="color: #fff; font-size: 20px;"><i class="fab fa-telegram"></i></a>
                    </div>
                </div>
            </div>

        </div>

        <hr style="border: 0; border-top: 1px solid #222; margin: 40px 0 20px;">
        
        <p style="text-align: center; color: #555; font-size: 12px;">
            &copy; 2024 - 2026 <b>HOANGKUN STORE</b>. All Rights Reserved. Thi·∫øt k·∫ø b·ªüi <b>Nguyen Viet Hoang</b>
        </p>
    </div>
</footer>

<div id="profile-page" style="display: none; background: #f4f6f9; min-height: 100vh; padding: 20px 0; position: fixed; top: 0; left: 0; width: 100%; z-index: 10000; overflow-y: auto;">
    <div class="container" style="max-width: 1000px; margin: auto; font-family: sans-serif;">
        <div style="background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 20px;">
            <h4 style="border-left: 5px solid #d9534f; padding-left: 15px; color: #333; margin: 0; text-align: left;">TH√îNG TIN T√ÄI KHO·∫¢N</h4>
            <hr style="border: 0.5px solid #eee; margin: 15px 0;">
            <p style="font-size: 16px; color: #555; text-align: left;">T√™n t√†i kho·∫£n: <b id="p-username-display" style="color: #d9534f;">---</b></p>
        </div>

        <div style="background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
            <h4 style="border-left: 5px solid #d9534f; padding-left: 15px; color: #333; margin-bottom: 20px; text-align: left;">L·ªäCH S·ª¨ BI·∫æN ƒê·ªòNG S·ªê D∆Ø</h4>
            <div style="overflow-x: auto;">
                <table style="width: 100%; border-collapse: collapse; min-width: 600px;">
                    <thead>
                        <tr style="background: #f8f9fa; border-bottom: 2px solid #dee2e6;">
                            <th style="padding: 12px; text-align: left; color: #444;">Th·ªùi gian</th>
                            <th style="padding: 12px; text-align: left; color: #444;">S·ªë ti·ªÅn</th>
                            <th style="padding: 12px; text-align: left; color: #444;">S·ªë d∆∞ cu·ªëi</th>
                            <th style="padding: 12px; text-align: left; color: #444;">N·ªôi dung</th>
                        </tr>
                    </thead>
                    <tbody id="wallet-history-body" style="color: #333;">
                        <tr><td colspan="4" style="text-align:center; padding:30px; color: #999;">ƒêang t·∫£i l·ªãch s·ª≠...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div style="text-align: center; margin-top: 30px;">
            <button onclick="closeProfile()" style="padding: 12px 30px; cursor: pointer; background: #333; color: #fff; border: none; border-radius: 5px; font-weight: bold;">
                <i class="fas fa-arrow-left"></i> QUAY L·∫†I C·ª¨A H√ÄNG
            </button>
        </div>
    </div>
</div>
    
<style>
@keyframes bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
}

    @keyframes pulseBtn {
    0% { transform: translate(-50%, -50%) scale(1); }
    50% { transform: translate(-50%, -50%) scale(1.1); box-shadow: 0 0 20px rgba(255, 65, 108, 0.6); }
    100% { transform: translate(-50%, -50%) scale(1); }
}

#spinBtn:not(:disabled) {
    animation: pulseBtn 1.5s infinite;
}
    
</style>

    <a href="spin.html" class="spin-sticker">
    <div class="sticker-content">
        <i class="fas fa-dharmachakra"></i> </div>
    <span class="sticker-tag">QUAY NGAY</span>
</a>

<style>
    /* Sticker n·∫±m g√≥c tr√°i d∆∞·ªõi */
    .spin-sticker {
        position: fixed;
        bottom: 30px;
        left: 30px;
        width: 70px;
        height: 70px;
        background: radial-gradient(circle, #ff0000, #800000);
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        text-decoration: none;
        box-shadow: 0 0 20px rgba(255, 0, 0, 0.6);
        border: 3px solid #fff;
        z-index: 9999;
        transition: transform 0.3s;
        animation: floatSticker 3s ease-in-out infinite;
    }

    .spin-sticker:hover {
        transform: scale(1.1) rotate(10deg);
        box-shadow: 0 0 30px #ff0000;
    }

    /* Icon b√°nh xe xoay tr√≤n m√£i m√£i */
    .sticker-content i {
        font-size: 35px;
        color: #fff;
        animation: spinInfinite 4s linear infinite;
    }

    /* Ch·ªØ "QUAY NGAY" nh·ªè ·ªü d∆∞·ªõi */
    .sticker-tag {
        position: absolute;
        bottom: -12px;
        background: #ffff00;
        color: #ff0000;
        font-size: 10px;
        font-weight: 900;
        padding: 2px 8px;
        border-radius: 10px;
        border: 1px solid #ff0000;
        white-space: nowrap;
        box-shadow: 0 2px 5px rgba(0,0,0,0.5);
    }

    @keyframes spinInfinite {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    @keyframes floatSticker {
        0%, 100% { bottom: 30px; }
        50% { bottom: 40px; } /* Hi·ªáu ·ª©ng bay l√™n xu·ªëng nh·∫π */
    }
</style>

    <script>
// --- X·ª¨ L√ù N·∫†P TI·ªÄN AUTO MB BANK ---
function createPaymentQR() {
    const amountInput = document.getElementById('auto-amount').value;
    const amount = parseInt(amountInput);
    const user = localStorage.getItem('hoangUser');

    if (!user) {
        closeRecharge();
        if(typeof showAuth === 'function') showAuth(false);
        return Swal.fire("Th√¥ng b√°o", "Vui l√≤ng ƒëƒÉng nh·∫≠p ƒë·ªÉ n·∫°p ti·ªÅn!", "warning");
    }

    if (!amount || amount < 10000) {
        return Swal.fire("L·ªói", "Vui l√≤ng n·∫°p t·ªëi thi·ªÉu 10.000ƒë", "error");
    }

    // --- QUAN TR·ªåNG: D√≤ng n√†y ƒë·ªÉ ng·∫Øt c√°c b·ªô l·∫Øng nghe c≈©, gi√∫p t·∫°o nhi·ªÅu m√£ kh√¥ng b·ªã l·ªói ---
    db.ref('deposit_requests').off(); 

    const memo = "nap " + user;
    const qrSource = `https://img.vietqr.io/image/MB-88812072006888-compact2.jpg?amount=${amount}&addInfo=${encodeURIComponent(memo)}`;

    document.getElementById('qr-image').src = qrSource;
    const amountEl = document.getElementById('display-amount');
    if(amountEl) amountEl.innerText = amount.toLocaleString() + 'ƒë';
    const memoEl = document.getElementById('display-memo');
    if(memoEl) memoEl.innerText = memo;

    document.getElementById('step-1-input').style.display = 'none';
    document.getElementById('step-2-qr').style.display = 'block';

    listenForMoney(user);
}

function resetRecharge() {
    document.getElementById('step-1-input').style.display = 'block';
    document.getElementById('step-2-qr').style.display = 'none';
    document.getElementById('auto-amount').value = '';
}

let lastDepositTime = Date.now(); // Bi·∫øn ch·∫∑n giao d·ªãch c≈©

function listenForMoney(user) {
    // Ch·ªâ l·∫Øng nghe b·∫£n ghi m·ªõi nh·∫•t v·ª´a ƒë∆∞·ª£c th√™m v√†o
    db.ref('deposit_requests')
      .orderByChild('user')
      .equalTo(user)
      .limitToLast(1)
      .on('child_added', snapshot => {
        const data = snapshot.val();
        
        // Ki·ªÉm tra n·∫øu tr·∫°ng th√°i trong database ƒë√£ ƒë·ªïi th√†nh Th√†nh c√¥ng
        if (data && data.status === "Th√†nh c√¥ng") {
            // Ng·∫Øt k·∫øt n·ªëi ngay l·∫≠p t·ª©c ƒë·ªÉ l·∫ßn t·∫°o m√£ sau kh√¥ng b·ªã b√°o l·∫∑p
            db.ref('deposit_requests').off(); 
            
            Swal.fire({
                title: "Th√†nh c√¥ng!",
                text: `ƒê√£ nh·∫≠n ƒë∆∞·ª£c +${parseInt(data.amount).toLocaleString()}ƒë`,
                icon: "success",
                confirmButtonText: "Tuy·ªát v·ªùi"
            }).then(() => {
                location.reload(); 
            });
        }
    });
}
        // --- X·ª¨ L√ù N·∫†P TH·∫∫ C√ÄO (TI·∫æNG VI·ªÜT) ---

function selectTelco(element, telcoName) {
    document.querySelectorAll('.telco-btn').forEach(btn => {
        btn.classList.remove('active');
        btn.style.border = "1px solid #ddd";
        btn.style.background = "transparent";
    });
    element.classList.add('active');
    element.style.border = "1px solid #ff9900";
    element.style.background = "#fffbe6";
    document.getElementById('card-telco').value = telcoName;
}

function sendCardAuto() {
    const user = localStorage.getItem('hoangUser');
    if(!user) return Swal.fire("L·ªói", "Vui l√≤ng ƒëƒÉng nh·∫≠p tr∆∞·ªõc!", "error");

    const telco = document.getElementById('card-telco').value;
    const amount = document.getElementById('card-amount').value;
    const pin = document.getElementById('card-pin').value;
    const serial = document.getElementById('card-serial').value;

    if(!amount) return Swal.fire("Thi·∫øu th√¥ng tin", "B·∫°n ch∆∞a ch·ªçn m·ªánh gi√° th·∫ª!", "warning");
    if(pin.length < 9 || serial.length < 9) return Swal.fire("Sai m√£ th·∫ª", "M√£ th·∫ª ho·∫∑c Seri qu√° ng·∫Øn, vui l√≤ng ki·ªÉm tra l·∫°i!", "warning");

    Swal.fire({
        title: 'ƒêang g·ª≠i th·∫ª...',
        html: 'H·ªá th·ªëng ƒëang ki·ªÉm tra th·∫ª <b>' + telco + '</b>...',
        allowOutsideClick: false,
        didOpen: () => { Swal.showLoading(); }
    });

    setTimeout(() => {
        db.ref('card_requests').push({
            username: user,
            telco: telco,
            amount: parseInt(amount),
            pin: pin,
            serial: serial,
            status: "pending",
            time: new Date().toLocaleString('vi-VN')
        }).then(() => {
            Swal.fire({
                title: "G·ª≠i th√†nh c√¥ng!",
                text: "Th·∫ª ƒëang ƒë∆∞·ª£c duy·ªát. Ti·ªÅn s·∫Ω v·ªÅ sau 1-5 ph√∫t n·∫øu th·∫ª ƒë√∫ng.",
                icon: "success",
                confirmButtonColor: "#ff9900",
                confirmButtonText: "ƒê√£ hi·ªÉu"
            });
            document.getElementById('card-pin').value = "";
            document.getElementById('card-serial').value = "";
        }).catch(err => {
            Swal.fire("L·ªói k·∫øt n·ªëi", "Kh√¥ng th·ªÉ g·ª≠i th·∫ª l√∫c n√†y: " + err.message, "error");
        });
    }, 1500); 
}
        
</script>

    <style>
    #fake-toast {
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 9999;
        font-family: 'Roboto', sans-serif;
        pointer-events: none; /* ƒê·ªÉ kh√°ch kh√¥ng b·∫•m nh·∫ßm */
    }
    
    .toast-item {
        background: rgba(0, 0, 0, 0.85);
        color: #fff;
        padding: 12px 20px;
        border-radius: 50px;
        margin-top: 10px;
        border: 1px solid #d32f2f; /* Vi·ªÅn ƒë·ªè theo t√¥ng web */
        box-shadow: 0 5px 15px rgba(0,0,0,0.5);
        display: flex;
        align-items: center;
        gap: 10px;
        animation: slideInLeft 0.5s ease, fadeOut 0.5s 4s forwards;
        min-width: 250px;
    }

    .toast-item i {
        color: #ffd700; /* M√†u v√†ng kim */
        font-size: 1.2rem;
    }

    .toast-content {
        display: flex;
        flex-direction: column;
    }

    .toast-name { font-weight: bold; color: #d32f2f; font-size: 0.9rem; }
    .toast-msg { font-size: 0.85rem; color: #eee; }

    @keyframes slideInLeft {
        from { opacity: 0; transform: translateX(-100px); }
        to { opacity: 1; transform: translateX(0); }
    }
    @keyframes fadeOut {
        from { opacity: 1; }
        to { opacity: 0; transform: translateY(-20px); }
    }
</style>

<div id="fake-toast"></div>

<script>
   // Danh s√°ch t√™n kh√°ch h√†ng (Random cho t·ª± nhi√™n)
    const names = ["Ho√†ng Dev", "Minh Tu·∫•n", "Thanh T√πng", "Ph·∫°m Quang", "Huy Code", "Ti·∫øn ƒê·∫°t", "Linh PHP", "S∆°n T√πng", "ƒê·ª©c Anh", "Th·∫ßy Ba", "Nam Coder", "D≈©ng JS"];
    
    // DANH S√ÅCH H√ÄNH ƒê·ªòNG (L·∫•y ƒë√∫ng t√™n s·∫£n ph·∫©m tr√™n shop b·∫°n)
    const actions = [
        // Mua Code Tr√°i Tim (S·∫£n ph·∫©m hot)
        { msg: "v·ª´a mua Code Tr√°i Tim 1 - 22k", icon: "fas fa-heart", color: "#e91e63" },
        { msg: "v·ª´a mua Code Tr√°i Tim 3 (VIP) - 32k", icon: "fas fa-heart", color: "#e91e63" },
        { msg: "v·ª´a t·∫£i Source Code Tr√°i Tim 2", icon: "fas fa-download", color: "#2ecc71" },

        // Mua Code Game/Web
        { msg: "v·ª´a mua Code Game B·∫Øn Cung - 60k", icon: "fas fa-gamepad", color: "#f39c12" },
        { msg: "v·ª´a mua Code Web M√®o Cute - 75k", icon: "fas fa-cat", color: "#9b59b6" },
        { msg: "v·ª´a rinh ngay Code Web Shop - 350k", icon: "fas fa-shopping-cart", color: "#3498db" },
        { msg: "v·ª´a mua Code Hi·ªáu ·ª®ng R·ªìng - 69k", icon: "fas fa-dragon", color: "#c0392b" },

        // N·∫°p ti·ªÅn & Ho·∫°t ƒë·ªông kh√°c
        { msg: "v·ª´a n·∫°p th√†nh c√¥ng 50.000ƒë", icon: "fas fa-money-bill-wave", color: "#27ae60" },
        { msg: "v·ª´a n·∫°p th√†nh c√¥ng 100.000ƒë", icon: "fas fa-university", color: "#27ae60" },
        { msg: "v·ª´a ƒë√°nh gi√° 5 sao cho Shop", icon: "fas fa-star", color: "#f1c40f" }
    ];

    function showFakeNotification() {
        const container = document.getElementById('fake-toast');
        
        // Random d·ªØ li·ªáu
        const randomName = names[Math.floor(Math.random() * names.length)];
        const randomAction = actions[Math.floor(Math.random() * actions.length)];
        
        // Che t√™n cho uy t√≠n (V√≠ d·ª•: Ho√†ng Kun -> Ho√†n***)
        const maskedName = randomName.substring(0, 3) + "***";

        const toast = document.createElement('div');
        toast.className = 'toast-item';
        toast.innerHTML = `
            <i class="${randomAction.icon}"></i>
            <div class="toast-content">
                <span class="toast-name">${maskedName}</span>
                <span class="toast-msg">${randomAction.msg}</span>
            </div>
        `;

        container.appendChild(toast);

        // X√≥a th√¥ng b√°o sau 4.5 gi√¢y
        setTimeout(() => {
            toast.remove();
        }, 4500);
    }

    // Ch·∫°y ng·∫´u nhi√™n t·ª´ 3 ƒë·∫øn 8 gi√¢y m·ªôt l·∫ßn
    function loopNotification() {
        const randTime = Math.floor(Math.random() * 5000) + 3000;
        setTimeout(() => {
            showFakeNotification();
            loopNotification();
        }, randTime);
    }

    // B·∫Øt ƒë·∫ßu ch·∫°y
    loopNotification();
</script>

<script>
    document.addEventListener('click', function(e) {
        const amount = document.createElement('div');
        amount.innerHTML = '<i class="fas fa-dollar-sign" style="color:#ffd700"></i>'; 
        // Ho·∫∑c th√≠ch ch·ªØ th√¨ d√πng: amount.innerText = "+1";
        
        amount.style.position = 'absolute';
        amount.style.left = e.pageX + 'px';
        amount.style.top = e.pageY + 'px';
        amount.style.color = '#ffd700';
        amount.style.fontWeight = 'bold';
        amount.style.fontSize = '20px';
        amount.style.pointerEvents = 'none';
        amount.style.animation = 'floatUp 1s ease-out forwards';
        amount.style.zIndex = '10000';
        
        document.body.appendChild(amount);

        setTimeout(() => { amount.remove(); }, 1000);
    });

    // Th√™m style cho animation v√†o th·∫ª style c√≥ s·∫µn ho·∫∑c t·∫°o m·ªõi
    const styleSheet = document.createElement("style");
    styleSheet.innerText = `
        @keyframes floatUp {
            0% { transform: translateY(0) scale(1); opacity: 1; }
            100% { transform: translateY(-50px) scale(1.5); opacity: 0; }
        }
    `;
    document.head.appendChild(styleSheet);
</script>

    <style>
    #live-chat {
        position: fixed; bottom: 80px; left: 20px; /* G√≥c tr√°i d∆∞·ªõi, tr√™n c√°i th√¥ng b√°o ·∫£o */
        width: 300px; height: 350px;
        background: rgba(0, 0, 0, 0.9);
        border: 1px solid #d32f2f;
        border-radius: 10px;
        z-index: 9998;
        display: flex; flex-direction: column;
        box-shadow: 0 0 20px rgba(211, 47, 47, 0.3);
        font-family: 'Roboto', sans-serif;
        overflow: hidden;
        transition: 0.3s;
    }

    /* Ti√™u ƒë·ªÅ chat */
    .chat-header {
        background: linear-gradient(90deg, #d32f2f, #b71c1c);
        padding: 10px 15px;
        color: white; font-weight: bold; font-size: 0.9rem;
        display: flex; justify-content: space-between; align-items: center;
        cursor: pointer;
    }
    .online-count { font-size: 0.7rem; color: #ffd700; }

    /* N·ªôi dung chat */
    .chat-body {
        flex: 1; padding: 10px;
        overflow-y: auto;
        display: flex; flex-direction: column; gap: 8px;
    }
    /* T√πy ch·ªânh thanh cu·ªôn */
    .chat-body::-webkit-scrollbar { width: 5px; }
    .chat-body::-webkit-scrollbar-thumb { background: #555; }

    .chat-line { font-size: 0.85rem; color: #ddd; line-height: 1.4; animation: fadeIn 0.3s ease; }
    .c-name { color: #ffd700; font-weight: bold; margin-right: 5px; }
    .c-name.admin { color: #ff0000; text-shadow: 0 0 5px red; }
    .c-tag { background: #333; padding: 1px 4px; border-radius: 3px; font-size: 0.6rem; color: #aaa; margin-right: 5px; }
    .c-vip { background: #ffd700; color: #000; font-weight: bold; }

    /* √î nh·∫≠p li·ªáu (gi·∫£) */
    .chat-input {
        padding: 10px; border-top: 1px solid #333;
        background: #111;
    }
    .chat-input input {
        width: 100%; background: #222; border: none;
        padding: 8px; border-radius: 5px; color: #fff;
        outline: none; font-size: 0.8rem;
    }

    /* N√∫t thu nh·ªè */
    .minimized { height: 40px !important; }
    .toggle-btn { transition: 0.3s; }
    .minimized .toggle-btn { transform: rotate(180deg); }

</style>

<div id="live-chat">
    <div class="chat-header" onclick="toggleChat()">
        <span><i class="fas fa-comment-dots"></i> K√äNH TH·∫æ GI·ªöI <span class="online-count">‚óè 142 Online</span></span>
        <i class="fas fa-chevron-down toggle-btn"></i>
    </div>
    <div class="chat-body" id="chat-content">
        <div class="chat-line"><span class="c-tag" style="background:red;color:#fff">H·ªá th·ªëng</span> Ch√†o m·ª´ng b·∫°n ƒë·∫øn v·ªõi HoangKun Store!</div>
    </div>
    <div class="chat-input">
    <input type="text" id="myMsg" placeholder="Nh·∫≠p tin nh·∫Øn..." onkeypress="sendMyMessage(event)">
</div>
</div>

<script>
    
    const chatContent = document.getElementById('chat-content');
    const chatBox = document.getElementById('live-chat');
    
    // Danh s√°ch t√™n bot
    const botNames = ["H√πng D≈©ng", "Nam Cao", "Th√°nh Quay", "B√° ƒê·∫°o", "Gamer Th·ªß ƒê√¥", "M√®o B√©o", "Ch√∫a H·ªÅ", "Rick Kid", "Tu·∫•n H∆∞ng", "Kh√°ch V√£ng Lai"];
    
    // K·ªãch b·∫£n chat (Content)
    const messages = [
        "Web n√†y n·∫°p th·∫ª Viettel ƒë∆∞·ª£c kh√¥ng ae?",
        "V·ª´a quay ra 50k th·∫ª c√†o, ngon cho√©t :v",
        "Admin ∆°i check h·ªô m√¨nh c√°i th·∫ª n·∫°p l√∫c n√£y v·ªõi",
        "Uy t√≠n nha, tui m·ªõi r√∫t xong.",
        "Web m∆∞·ª£t ƒë·∫•y, giao di·ªán ƒë·∫πp.",
        "C√≥ ai bi·∫øt c√°ch nh·∫≠n th√™m l∆∞·ª£t quay free ko?",
        "H√¥m nay ƒëen qu√°, quay to√†n v√†o √¥ 5k :(",
        "N·∫°p 100k ƒë∆∞·ª£c bao nhi√™u l∆∞·ª£t th·∫ø mn?",
        "Anh em n·∫°p Momo cho nhanh, ƒë·ª° b·ªã nu·ªët th·∫ª.",
        "√îng n√†o v·ª´a tr√∫ng 500k ƒë·∫•y, xin c√°i card 20k ƒëi!",
        "L·ª´a ƒë·∫£o kh√¥ng ƒë·∫•y ae?",
        "L·ª´a c√°i ƒë·∫ßu √¥ng, t√¥i ch∆°i t·ª´ th√°ng tr∆∞·ªõc r·ªìi.",
        "Admin rep tin nh·∫Øn nhanh v√£i."
    ];

    function addMessage(name, msg, isVip = false) {
        const div = document.createElement('div');
        div.className = 'chat-line';
        
        let tagHtml = '<span class="c-tag">Member</span>';
        if(isVip) tagHtml = '<span class="c-tag c-vip">VIP</span>';
        if(name === 'Admin') tagHtml = '<span class="c-tag" style="background:red;color:white">ADMIN</span>';

        div.innerHTML = `${tagHtml}<span class="c-name ${name==='Admin'?'admin':''}">${name}:</span> ${msg}`;
        
        chatContent.appendChild(div);
        chatContent.scrollTop = chatContent.scrollHeight; // T·ª± cu·ªôn xu·ªëng d∆∞·ªõi
    }

    function autoChat() {
        const randomName = botNames[Math.floor(Math.random() * botNames.length)];
        const randomMsg = messages[Math.floor(Math.random() * messages.length)];
        const isVip = Math.random() > 0.8; // 20% c∆° h·ªôi l√† VIP

        addMessage(randomName, randomMsg, isVip);
    }

    // Admin th·ªânh tho·∫£ng v√†o n√≥i 1 c√¢u
    function adminChat() {
        const adminMsgs = [
            "C√°c b·∫°n n·∫°p th·∫ª vui l√≤ng gi·ªØ l·∫°i seri ƒë·ªÉ ƒë·ªëi so√°t nh√©.",
            "H·ªá th·ªëng v·ª´a c·∫≠p nh·∫≠t th√™m th·∫ª Garena nh√© ae.",
            "Ch√∫c m·ª´ng b·∫°n **H√πng** v·ª´a tr√∫ng gi·∫£i ƒë·∫∑c bi·ªát!",
            "Anh em ch√∫ √Ω kh√¥ng spam k√™nh chat nh√©."
        ];
        addMessage("Admin", adminMsgs[Math.floor(Math.random() * adminMsgs.length)]);
    }

    // Ch·∫°y random chat
    function loopChat() {
        const randTime = Math.floor(Math.random() * 4000) + 2000; // 2-6 gi√¢y 1 tin
        setTimeout(() => {
            autoChat();
            loopChat();
        }, randTime);
    }

    // Ch·∫°y Admin chat (l√¢u l√¢u m·ªõi hi·ªán)
    setInterval(adminChat, 25000); 

    // B·∫Øt ƒë·∫ßu
    loopChat();

    // H√†m thu nh·ªè chat
    function toggleChat() {
        chatBox.classList.toggle('minimized');
    }

   // H√†m g·ª≠i tin nh·∫Øn c·ªßa b·∫°n (ƒê√£ s·ª≠a ƒë·ªÉ l·∫•y ƒë√∫ng t√™n nick ƒëang ƒëƒÉng nh·∫≠p)
    function sendMyMessage(event) {
        if (event.key === "Enter") {
            const input = document.getElementById('myMsg');
            const text = input.value.trim();
            
            // L·∫•y t√™n ng∆∞·ªùi d√πng t·ª´ b·ªô nh·ªõ (n·∫øu ch∆∞a ƒëƒÉng nh·∫≠p th√¨ hi·ªán l√† Kh√°ch)
            const currentUser = localStorage.getItem('hoangUser') || "Kh√°ch";

            if (text !== "") {
                // Thay "Ho√†ng Ch·ªß Shop" b·∫±ng bi·∫øn currentUser
                addMessage(currentUser, text, true); 
                input.value = ""; 
                const chatBody = document.getElementById('chat-content');
                chatBody.scrollTop = chatBody.scrollHeight;
            }
        }
    }

</script>

<script src="giftcode.js"></script>

<script src="thongbao.js"></script>
    
</body>
</html>
