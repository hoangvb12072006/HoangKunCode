<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HOANGKUN STORE - PREMIUM GAMING SHOP</title>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <style>

        /* Hi·ªáu ·ª©ng ch·ªØ l∆∞·ªõt s√°ng Gradient */
.glow-text {
    background: linear-gradient(to right, #ff0000 20%, #ffffff 40%, #ff4d4d 60%, #ff0000 80%);
    background-size: 200% auto;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    animation: shine-glow 4s linear infinite;
}

@keyframes shine-glow {
    to { background-position: 200% center; }
}

/* Hi·ªáu ·ª©ng d√≤ng ch·ªØ ph·ª• bay l√™n nh·∫π nh√†ng */
.sub-text {
    animation: fadeInUp 1.5s ease-out;
}

@keyframes fadeInUp {
    from { opacity: 0; transform: translateY(30px); }
    to { opacity: 0.9; transform: translateY(0); }
}

/* Hi·ªáu ·ª©ng bo g√≥c v√† ƒë·ªï b√≥ng cho ·∫£nh s·∫£n ph·∫©m */
.thumb img {
    transition: transform 0.5s ease;
}
.card:hover .thumb img {
    transform: scale(1.1); /* Ph√≥ng to nh·∫π ·∫£nh khi di chu·ªôt v√†o */
}

/* L√†m cho c√°c n√∫t li√™n h·ªá (Zalo, FB) rung nh·∫π ƒë·ªÉ thu h√∫t s·ª± ch√∫ √Ω */
@keyframes shake {
    0% { transform: rotate(0deg); }
    25% { transform: rotate(5deg); }
    50% { transform: rotate(-5deg); }
    100% { transform: rotate(0deg); }
}
.contact-item {
    animation: shake 2s infinite ease-in-out;
}

        .contact-sidebar {
    position: fixed;
    right: 20px;
    bottom: 80px;
    z-index: 999;
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.contact-item {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    color: white;
    text-decoration: none;
    font-size: 24px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    transition: 0.3s;
}

.contact-item:hover {
    transform: scale(1.1) translateX(-5px);
}

.zalo { background: #0068ff; }
.facebook { background: #1877f2; }
.telegram { background: #229ed9; }
        
        :root { --primary: #ff0000; --secondary: #121212; --accent: #ff4d4d; --text: #ffffff; --bg: #050505; --card-bg: #1a1a1a; }
        body { margin: 0; padding: 0; background-color: var(--bg); color: var(--text); font-family: 'Segoe UI', sans-serif; overflow-x: hidden; }
        
        /* Hi·ªáu ·ª©ng h·∫°t n·ªÅn */
        #particleCanvas { position: fixed; top: 0; left: 0; z-index: -1; background: radial-gradient(circle, #1a0000 0%, #050505 100%); }
        
        /* Navigation Bar */
        nav { background: rgba(0, 0, 0, 0.85); border-bottom: 2px solid var(--primary); padding: 15px 0; position: sticky; top: 0; z-index: 100; backdrop-filter: blur(15px); }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        .nav-content { display: flex; justify-content: space-between; align-items: center; }
/* T√¨m ƒë·∫øn d√≤ng 24 v√† thay b·∫±ng ƒëo·∫°n n√†y */
.logo {
    font-size: 26px;
    font-weight: 900;
    text-transform: uppercase;
    animation: rgb-glow 4s infinite linear; /* Th√™m d√≤ng n√†y ƒë·ªÉ k√≠ch ho·∫°t ƒë·ªïi m√†u */
}

/* Th√™m hi·ªáu ·ª©ng ch·∫°y m√†u v√†o b·∫•t k·ª≥ ƒë√¢u trong th·∫ª <style> */
@keyframes rgb-glow {
    0% { color: #ff0000; text-shadow: 0 0 15px #ff0000; }
    33% { color: #00ff00; text-shadow: 0 0 15px #00ff00; }
    66% { color: #00ffff; text-shadow: 0 0 15px #00ffff; }
    100% { color: #ff0000; text-shadow: 0 0 15px #ff0000; }
}
        /* N√∫t b·∫•m x·ªãn */
        .btn { padding: 10px 20px; border-radius: 8px; border: none; font-weight: bold; cursor: pointer; transition: 0.3s; text-transform: uppercase; }
        .btn-red { background: var(--primary); color: white; box-shadow: 0 0 15px rgba(255, 0, 0, 0.4); }
        .btn-red:hover { background: #ff3333; transform: scale(1.05); }
        
        /* Grid S·∫£n ph·∫©m */
        .shop-title { border-left: 5px solid var(--primary); padding-left: 15px; margin: 40px 0 20px; font-size: 22px; text-transform: uppercase; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 25px; }
        .card { background: var(--card-bg); border-radius: 15px; overflow: hidden; border: 1px solid #222; transition: 0.4s; position: relative; }
        .card:hover { transform: translateY(-10px); border-color: var(--primary); box-shadow: 0 10px 30px rgba(255,0,0,0.1); }
        .thumb { height: 180px; width: 100%; }
        .thumb img { width: 100%; height: 100%; object-fit: cover; }
        .card-body { padding: 20px; text-align: center; }
        .price { color: var(--primary); font-size: 22px; font-weight: 800; margin: 10px 0; }

        /* Modal h·ªá th·ªëng */
        .modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); display: none; align-items: center; justify-content: center; z-index: 1000; backdrop-filter: blur(10px); }
        .modal-content { background: #151515; padding: 35px; border-radius: 20px; border: 1px solid #333; max-width: 400px; width: 90%; text-align: center; position: relative; }
        .input-group { position: relative; margin-bottom: 15px; text-align: left; }
        .input-group input { width: 100%; padding: 12px 15px; background: #000; border: 1px solid #333; border-radius: 8px; color: #fff; box-sizing: border-box; outline: none; }
        .input-group input:focus { border-color: var(--primary); }
        
        /* Th√¥ng b√°o gi·∫£ l·∫≠p */
        .fake-noti { position: fixed; bottom: -100px; left: 20px; background: rgba(20, 20, 20, 0.95); padding: 12px 20px; border-left: 4px solid var(--primary); border-radius: 8px; transition: 0.5s; z-index: 999; display: flex; align-items: center; gap: 10px; font-size: 14px; }
        .fake-noti.show { bottom: 20px; }

        /* L·ªãch s·ª≠ mua h√†ng */
        .history-box { margin-top: 50px; background: #111; padding: 20px; border-radius: 15px; border: 1px solid #222; }
        table { width: 100%; border-collapse: collapse; margin-top: 15px; font-size: 14px; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #222; }
        th { color: var(--primary); }
        
    </style>
</head>
<body>

<canvas id="particleCanvas"></canvas>

<nav>
    <div class="container nav-content">
        <a href="#" class="logo">HOANGKUN<span>STORE</span></a>
        <div id="auth-section">
            <button class="btn btn-red" onclick="showAuth(false)">ƒêƒÇNG NH·∫¨P / ƒêƒÇNG K√ù</button>
        </div>
        <div id="user-section" style="display: none; align-items: center; gap: 15px;">
            <div style="font-size: 14px;">Xin ch√†o, <b id="display-name" style="color:var(--primary)">...</b></div>
            <div style="background: #222; padding: 5px 12px; border-radius: 20px; font-size: 14px;">
                <i class="fas fa-wallet" style="color:#00ff00"></i> <span id="user-balance">0ƒë</span>
            </div>
            <button class="btn btn-red" style="padding: 5px 10px; font-size: 12px;" onclick="showRecharge()">N·∫†P</button>
            <i class="fas fa-sign-out-alt" style="cursor:pointer; color: #666;" onclick="logout()"></i>
        </div>
    </div>
</nav>

<div class="container">
   <div class="banner" style="text-align: center; padding: 100px 0; background: linear-gradient(rgba(0,0,0,0.8), rgba(0,0,0,0.8)), url('https://i.postimg.cc/g2bY136T/Website-1024x538.png') center/cover; border-radius: 20px; margin-top: 20px; border: 1px solid #444; position: relative; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.5);">
    <h1 class="glow-text" style="font-size: 65px; margin: 0; letter-spacing: 4px; font-weight: 900; text-transform: uppercase; line-height: 1.2;">
        HOANGKUN STORE
    </h1>
    
    <div style="width: 120px; height: 4px; background: var(--primary); margin: 25px auto; border-radius: 10px; box-shadow: 0 0 20px var(--primary);"></div>
    
    <p class="sub-text" style="color: #ffffff; font-size: 18px; letter-spacing: 1px; opacity: 0.9; text-shadow: 1px 1px 5px rgba(0,0,0,0.5);">
        <i class="fas fa-check-circle" style="color: var(--primary);"></i> 
        H·ªÜ TH·ªêNG SOURCE CODE T·ª∞ ƒê·ªòNG - UY T√çN - B·∫¢O M·∫¨T
        <i class="fas fa-check-circle" style="color: var(--primary);"></i>
    </p>
</div>

    <div class="container" style="margin-top: 40px;">
    <div style="background: rgba(15, 15, 15, 0.95); border: 1px solid #333; border-radius: 20px; padding: 25px; box-shadow: 0 0 25px rgba(255, 0, 0, 0.15);">
        <h2 style="text-align: center; color: #fff; text-transform: uppercase; letter-spacing: 3px; margin-bottom: 25px; font-weight: 800;">
            <i class="fas fa-trophy" style="color: gold; margin-right: 10px;"></i> 
            TOP 10 ƒê·∫†I GIA N·∫†P NHI·ªÄU
            <i class="fas fa-trophy" style="color: gold; margin-left: 10px;"></i>
        </h2>
        <div class="table-responsive" style="border-radius: 15px; overflow: hidden;">
            <table class="table" style="color: white; margin-bottom: 0;">
                <thead style="background: linear-gradient(90deg, #ff0000, #990000); color: white;">
                    <tr>
                        <th style="text-align: center; width: 80px; border: none;">H·∫†NG</th>
                        <th style="border: none;">KH√ÅCH H√ÄNG</th>
                        <th style="text-align: center; border: none;">S·ªê D∆Ø HI·ªÜN T·∫†I</th>
                    </tr>
                </thead>
                <tbody id="top-nap-body">
                    </tbody>
            </table>
        </div>
    </div>
</div>

    <h2 class="shop-title"><i class="fas fa-fire"></i> S·∫£n ph·∫©m m·ªõi nh·∫•t</h2>
    <div class="grid" id="productGrid"></div>

   <div id="history-section" class="history-box" style="display:none; border: 1px solid var(--primary); margin-top: 30px;">
    <h3 style="color: var(--primary); text-align: center;"><i class="fas fa-shopping-cart"></i> L·ªäCH S·ª¨ GIAO D·ªäCH & KHO CODE</h3>
    <table style="width: 100%; border-collapse: collapse; table-layout: fixed;">
        <thead>
            <tr style="background: #222; color: #fff;">
                <th style="width: 30%; padding: 10px; border: 1px solid #333;">T√™n S·∫£n Ph·∫©m</th>
                <th style="width: 15%; border: 1px solid #333;">Gi√°</th>
                <th style="width: 30%; border: 1px solid #333;">Ng√†y Mua</th>
                <th style="width: 25%; border: 1px solid #333;">Link T·∫£i</th>
            </tr>
        </thead>
        <tbody id="history-body"></tbody>
    </table>
</div>
    
<div id="authModal" class="modal">
    <div class="modal-content">
        <h2 id="authTitle" style="margin-top:0">LOGIN</h2>
        <div class="input-group">
            <label style="font-size: 12px; color: #666;">T√™n t√†i kho·∫£n</label>
            <input type="text" id="userInput" placeholder="G√µ t√™n t√†i kho·∫£n...">
        </div>
        <div class="input-group">
            <label style="font-size: 12px; color: #666;">M·∫≠t kh·∫©u</label>
            <input type="password" id="passInput" placeholder="*******">
        </div>
        <div id="regFields" style="display: none;">
            <div class="input-group">
                <label style="font-size: 12px; color: #666;">X√°c nh·∫≠n m·∫≠t kh·∫©u</label>
                <input type="password" id="confirmInput" placeholder="*******">
            </div>
        </div>
        <button class="btn btn-red" style="width: 100%; margin-top: 10px;" onclick="handleAuth()">X√ÅC NH·∫¨N</button>
        <p class="auth-switch">
            <span id="switchText">Ch∆∞a c√≥ t√†i kho·∫£n?</span> 
            <b onclick="toggleAuth()" style="color:var(--primary); cursor:pointer">B·∫•m v√†o ƒë√¢y</b>
        </p>o
        <div style="margin-top: 20px; font-size: 13px; color: #444; cursor: pointer;" onclick="closeModal('authModal')">ƒê√≥ng c·ª≠a s·ªï</div>
    </div>
</div>

<div id="rechargeModal" class="modal">
    <div class="modal-content">
        <h2 style="color:var(--primary)">N·∫†P TI·ªÄN</h2>
        <div style="background: #000; padding: 15px; border-radius: 10px; text-align: left; font-size: 14px; line-height: 1.8;">
            <div>Ng√¢n h√†ng: <b>TECHCOMBANK</b></div>
            <div>S·ªë t√†i kho·∫£n: <b style="color: #00ff00;">3120720060</b></div>
            <div>Ch·ªß TK: <b>NGUYEN VIET HOANG</b></div>
            <div style="border-top: 1px dashed #333; margin-top: 10px; padding-top: 10px;">
                N·ªôi dung chuy·ªÉn kho·∫£n:<br>
                <b style="color: var(--primary); font-size: 18px;">NAP <span id="ck-name">...</span></b>
            </div>
        </div>
        <p style="font-size: 12px; color: #666; margin-top: 15px;">Vui l√≤ng chuy·ªÉn ƒë√∫ng n·ªôi dung. Ti·ªÅn s·∫Ω ƒë∆∞·ª£c c·ªông sau 1-5 ph√∫t.</p>
        <button class="btn btn-red" style="width: 100%;" onclick="closeModal('rechargeModal')">T√îI ƒê√É CHUY·ªÇN</button>
    </div>
</div>

<div id="fakeNoti" class="fake-noti">
    <i class="fas fa-check-circle" style="color: #00ff00;"></i>
    <span id="fakeNotiText"></span>
</div>

<script>
    // --- 1. K·∫æT N·ªêI FIREBASE ---
    const firebaseConfig = {
        apiKey: "AIzaSyDqpk71mVDWCP3jk7fxbHZayz92LTheY7g",
        databaseURL: "https://hoangkun-594d0-default-rtdb.firebaseio.com",
    };
    if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // --- 2. D·ªÆ LI·ªÜU C·ª¨A H√ÄNG ---
   const products = [
    { id: 1, name: "CODE TRAITYM 1", price: 22000, img: "https://cellphones.com.vn/sforum/wp-content/uploads/2024/03/Huong-dan-tao-code-trai-tim-html-tang-nguoi-than-yeu-nhan-ngay-8-3-3.jpg", link: "https://www.mediafire.com/file/x82cfpep8576y2m/Code_tr%25C3%25A1i_tym_1.zip/file" },
    { id: 2, name: "CODE TRAITYM 2", price: 28000, img: "https://cellphones.com.vn/sforum/wp-content/uploads/2024/03/Huong-dan-tao-code-trai-tim-html-tang-nguoi-than-yeu-nhan-ngay-8-3-9.jpg", link: "https://www.mediafire.com/file/9ouog8a5ot8bbjr/Code_tr%25C3%25A1i_tym_2.zip/file" },
    { id: 3, name: "CODE TRAITYM 3", price: 32000, img: "https://cellphones.com.vn/sforum/wp-content/uploads/2024/03/Huong-dan-tao-code-trai-tim-html-tang-nguoi-than-yeu-nhan-ngay-8-3-13.jpg", link: "https://www.mediafire.com/file/y5koz065nphas87/Code_tr%25C3%25A1i_tym_3.zip/file" },
    { id: 4, name: "CODE WEB SHOP", price: 350000, img: "https://i.postimg.cc/JzmdcN7p/game-title.jpg", link: "https://www.mediafire.com/file/kpd7vqbm7235b46/Code+website+Game.zip/file" },
    { id: 5, name: "CODE GAME B·∫ÆN CUNG", price: 60000, img: "https://i.postimg.cc/svBYRYkr/IMG-6222.png", link: "https://www.mediafire.com/file/fppnwb0cye4f8p7/Code_ba%25CC%2586%25CC%2581n_cung.zip/file" },
    { id: 6, name: "CODE WEB M√àO CUTE", price: 75000, img: "https://i.postimg.cc/QKFThDy3/IMG-6223.gif", link: "https://www.mediafire.com/file/tcobfv1lccqrvjb/Code_chu%25CC%2581c_mu%25CC%259B%25CC%2580ng_sinh_nha%25CC%25A3%25CC%2582t_1.zip/file" },
    { id: 7, name: "CODE HI·ªÜU ·ª®NG R·ªíNG", price: 69000, img: "https://i.postimg.cc/Czfq2F8R/IMG-6224.gif", link: "https://www.mediafire.com/file/csvufyf40lrz37s/Code_hie%25CC%25A3%25CC%2582u_u%25CC%259B%25CC%2581ng_tro%25CC%2589_chuo%25CC%25A3%25CC%2582t_1.zip/file" },
    { id: 8, name: "CODE HI·ªÜU ·ª®NG CHU·ªòT 2", price: 65000, img: "https://i.postimg.cc/K3mMVW6Q/IMG-6225.gif", link: "https://www.mediafire.com/file/rzwparz9rv49icq/Code_Hie%25CC%25A3%25CC%2582u_U%25CC%259B%25CC%2581ng_Chuo%25CC%25A3%25CC%2582t_2.zip/file" },
    { id: 9, name: "CODE HI·ªÜU ·ª®NG CHU·ªòT 3", price: 67000, img: "https://i.postimg.cc/Bt3HX8jF/IMG-6226.gif", link: "https://www.mediafire.com/file/kueqacmv4wi1cuv/Code_Hie%25CC%25A3%25CC%2582u_U%25CC%259B%25CC%2581ng_Chuo%25CC%25A3%25CC%2582t_3.zip/file" },
    { id: 10, name: "Code Th∆∞ T·ªè T√¨nh", price: 50000, img: "https://i.postimg.cc/q62Czw4K/IMG-6227.gif", link: "https://www.mediafire.com/file/689n10vjdpsnnfv/Code_Thu%25CC%259B_To%25CC%2589_Ti%25CC%2580nh.zip/file" },
    { id: 11, name: "Code Thi·ªáp Ch√∫c Gi√°ng Sinh", price: 51000, img: "https://i.postimg.cc/3yHJnG5Y/IMG-6228.png", link: "https://www.mediafire.com/file/t914seytwtw0me0/Code_Thu%25CC%259B_Gia%25CC%2581ng_Sinh.zip/file" },
    { id: 12, name: "CODE HI·ªÜU ·ª®NG CHU·ªòT 4", price: 63000, img: "https://i.postimg.cc/NKjWYf6d/IMG-6231.gif", link: "https://www.mediafire.com/file/e064bjd9uyb8z75/Code_Hie%25CC%25A3%25CC%2582u_U%25CC%259B%25CC%2581ng_Chuo%25CC%25A3%25CC%2582t_4.zip/file" },
    { id: 13, name: "CODE HI·ªÜU ·ª®NG CHU·ªòT 5", price: 58000, img: "https://i.postimg.cc/HrkfHswf/IMG-6232.gif", link: "https://www.mediafire.com/file/6zwm6ew9ygnr1u3/Code_Hie%25CC%25A3%25CC%2582u_U%25CC%259B%25CC%2581ng_Chuo%25CC%25A3%25CC%2582t_5.zip/file" },
    { id: 14, name: "CODE HI·ªÜU ·ª®NG LOADDING", price: 21000, img: "https://i.postimg.cc/pmLgxXfS/IMG-6233.png", link: "https://www.mediafire.com/file/zgsje7jjri4wh7t/Code_Hie%25CC%25A3%25CC%2582u_U%25CC%259B%25CC%2581ng_Loadding.zip/file" }
    { id: 15, name: "Code Qly Web Tr∆∞·ªùng H·ªçc", price: 100000, img: "https://i.postimg.cc/G3B9xytZ/Untitled.png", link: "https://www.mediafire.com/file/xd5x96ia1g6arbv/Code+website+qu·∫£n+l√Ω+tr∆∞·ªùng+h·ªçc.zip/file" },
   ];
    function renderProducts() {
        document.getElementById('productGrid').innerHTML = products.map(p => `
            <div class="card">
                <div class="thumb"><img src="${p.img}"></div>
                <div class="card-body">
                    <h3 style="font-size:16px; margin:0;">${p.name}</h3>
                    <div class="price">${p.price.toLocaleString()}ƒë</div>
                    <button class="btn btn-red" style="width:100%" onclick="buyItem('${p.name}', ${p.price}, '${p.link}')">MUA NGAY</button>
                </div>
            </div>
        `).join('');
    }

    // --- 3. LOGIC T√ÄI KHO·∫¢N (ƒê√É FIX L·ªñI) ---
    let isRegisterMode = false;

    function showAuth(isReg) {
        isRegisterMode = isReg;
        updateAuthUI();
        document.getElementById('authModal').style.display = 'flex';
    }

    function toggleAuth() {
        isRegisterMode = !isRegisterMode;
        updateAuthUI();
    }

    function updateAuthUI() {
        document.getElementById('authTitle').innerText = isRegisterMode ? "ƒêƒÇNG K√ù" : "ƒêƒÇNG NH·∫¨P";
        document.getElementById('regFields').style.display = isRegisterMode ? "block" : "none";
        document.getElementById('switchText').innerText = isRegisterMode ? "ƒê√£ c√≥ t√†i kho·∫£n?" : "Ch∆∞a c√≥ t√†i kho·∫£n?";
    }

    function handleAuth() {
        const user = document.getElementById('userInput').value.trim().toLowerCase();
        const pass = document.getElementById('passInput').value;

        if(!user || !pass) return Swal.fire("L·ªói", "Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß!", "error");

        if(isRegisterMode) {
            const confirm = document.getElementById('confirmInput').value;
            if(pass !== confirm) return Swal.fire("L·ªói", "M·∫≠t kh·∫©u kh√¥ng kh·ªõp!", "error");

            db.ref('users/' + user).once('value').then(snap => {
                if(snap.exists()) {
                    Swal.fire("L·ªói", "T√™n t√†i kho·∫£n ƒë√£ t·ªìn t·∫°i!", "error");
                } else {
                    db.ref('users/' + user).set({
                        pass: pass,
                        balance: 0,
                        createdAt: new Date().toLocaleString()
                    }).then(() => {
                        Swal.fire("Th√†nh c√¥ng", "ƒêƒÉng k√Ω th√†nh c√¥ng! H√£y ƒëƒÉng nh·∫≠p.", "success");
                        isRegisterMode = false;
                        updateAuthUI();
                    });
                }
            });
        } else {
            db.ref('users/' + user).once('value').then(snap => {
                const data = snap.val();
                if(data && data.pass === pass) {
                    localStorage.setItem('hoangUser', user);
                    Swal.fire("Ch√†o m·ª´ng", "ƒêƒÉng nh·∫≠p th√†nh c√¥ng!", "success").then(() => location.reload());
                } else {
                    Swal.fire("L·ªói", "Sai t√†i kho·∫£n ho·∫∑c m·∫≠t kh·∫©u!", "error");
                }
            });
        }
    }

    // --- 4. QU·∫¢N L√ù TR·∫†NG TH√ÅI NG∆Ø·ªúI D√ôNG ---
    function checkLogin() {
        const user = localStorage.getItem('hoangUser');
        if(user) {
            document.getElementById('auth-section').style.display = 'none';
            document.getElementById('user-section').style.display = 'flex';
            document.getElementById('history-section').style.display = 'block';
            document.getElementById('display-name').innerText = user;
            document.getElementById('ck-name').innerText = user.toUpperCase();
            
            // L·∫Øng nghe s·ªë d∆∞ th·ª±c t·∫ø t·ª´ Firebase
            db.ref('users/' + user).on('value', snap => {
                const data = snap.val();
                if(data) {
                    const balance = data.balance || 0;
                    document.getElementById('user-balance').innerText = balance.toLocaleString() + 'ƒë';
                    localStorage.setItem('hoangBal', balance);
                }
            });

            // T·∫£i l·ªãch s·ª≠ mua h√†ng
           loadHistory(user);
        }
    }

   function buyItem(name, price, downloadLink) {
    const user = localStorage.getItem('hoangUser');
    if(!user) return showAuth(false);

    const currentBal = parseInt(localStorage.getItem('hoangBal') || 0);
    if(currentBal < price) {
        Swal.fire("Thi·∫øu ti·ªÅn", "S·ªë d∆∞ kh√¥ng ƒë·ªß!", "warning").then(() => showRecharge());
        return;
    }

    Swal.fire({
        title: 'X√°c nh·∫≠n mua?',
        text: `Mua ${name} v·ªõi gi√° ${price.toLocaleString()}ƒë?`,
        icon: 'question',
        showCancelButton: true,
        confirmButtonColor: '#ff0000',
        confirmButtonText: 'MUA NGAY'
    }).then((result) => {
        if (result.isConfirmed) {
            const newBal = currentBal - price;
            const now = new Date().toLocaleString();

            // Ch·ªâ l∆∞u v√†o 1 b·∫£ng duy nh·∫•t l√† 'history' nh∆∞ng c√≥ th√™m link
            db.ref('history/' + user).push({
                product: name,
                price: price,
                date: now,
                link: downloadLink, // L∆∞u link v√†o ƒë√¢y lu√¥n
                status: "Th√†nh c√¥ng"
            });

            // C·∫≠p nh·∫≠t ti·ªÅn
            db.ref('users/' + user).update({ balance: newBal }).then(() => {
                Swal.fire("Th√†nh c√¥ng!", "S·∫£n ph·∫©m ƒë√£ ƒë∆∞·ª£c th√™m v√†o l·ªãch s·ª≠ b√™n d∆∞·ªõi.", "success");
            });
        }
    });
}
  function loadHistory(user) {
    db.ref('history/' + user).on('value', snap => {
        const historyBody = document.getElementById('history-body');
        const data = snap.val();
        if(!data) {
            historyBody.innerHTML = '<tr><td colspan="4" style="text-align:center">Ch∆∞a c√≥ giao d·ªãch n√†o</td></tr>';
            return;
        }

        let html = '';
        for(let id in data) {
            html = `<tr>
                <td style="color:#fff; padding: 10px; border: 1px solid #333;">${data[id].product}</td>
                <td style="color:var(--primary); border: 1px solid #333;">${(data[id].price || 0).toLocaleString()}ƒë</td>
                <td style="color:#ccc; font-size: 13px; border: 1px solid #333;">${data[id].date}</td>
                <td style="text-align: center; border: 1px solid #333;">
                    <a href="${data[id].link || '#'}" target="_blank" 
                       style="color:#00ff00; text-decoration:none; font-weight:bold; border:1px solid #00ff00; padding:3px 8px; border-radius:4px; font-size:12px;">
                       <i class="fas fa-download"></i> T·∫¢I V·ªÄ
                    </a>
                </td>
            </tr>` + html;
        }
        historyBody.innerHTML = html;
    });
}

    function logout() { localStorage.removeItem('hoangUser'); location.reload(); }
    function closeModal(id) { document.getElementById(id).style.display = 'none'; }
    function showRecharge() { document.getElementById('rechargeModal').style.display = 'flex'; }

    // --- 5. HI·ªÜU ·ª®NG V√Ä TRANG TR√ç ---
    function initParticles() {
        const canvas = document.getElementById('particleCanvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth; canvas.height = window.innerHeight;
        let particles = [];
        for(let i=0; i<60; i++) {
            particles.push({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                vx: Math.random() - 0.5,
                vy: Math.random() - 0.5
            });
        }
        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = "rgba(255, 0, 0, 0.2)";
            particles.forEach(p => {
                p.x += p.vx; p.y += p.vy;
                if(p.x < 0 || p.x > canvas.width) p.vx *= -1;
                if(p.y < 0 || p.y > canvas.height) p.vy *= -1;
                ctx.beginPath(); ctx.arc(p.x, p.y, 2, 0, Math.PI*2); ctx.fill();
            });
            requestAnimationFrame(animate);
        }
        animate();
    }

    function startFakeNoti() {
        const names = ["Qu·ªëc B·∫£o", "VƒÉn Nam", "Thanh T√πng", "Minh H·∫±ng", "ƒê·ª©c Huy"];
        const prices = ["50,000ƒë", "200,000ƒë", "100,000ƒë", "500,000ƒë"];
        setInterval(() => {
            const noti = document.getElementById('fakeNoti');
            document.getElementById('fakeNotiText').innerHTML = `Kh√°ch h√†ng <b>${names[Math.floor(Math.random()*names.length)]}</b> v·ª´a n·∫°p th√†nh c√¥ng ${prices[Math.floor(Math.random()*prices.length)]}`;
            noti.classList.add('show');
            setTimeout(() => noti.classList.remove('show'), 5000);
        }, 12000);
    }

    window.onload = () => {
        initParticles();
        renderProducts();
        checkLogin();
        startFakeNoti();
    };
</script>

    <script>
    const canvas = document.getElementById('particleCanvas');
    if(canvas) {
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        let particles = [];
        for(let i=0; i<100; i++) {
            particles.push({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                size: Math.random() * 2 + 1,
                speedY: Math.random() * 1 + 0.5
            });
        }
        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = 'rgba(255, 0, 0, 0.5)';
            particles.forEach(p => {
                p.y -= p.speedY;
                if(p.y < 0) p.y = canvas.height;
                ctx.beginPath();
                ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
                ctx.fill();
            });
            requestAnimationFrame(animate);
        }
        animate();
    }

        function loadBoughtCodes(user) {
    db.ref('bought_codes/' + user).on('value', snap => {
        const data = snap.val();
        const body = document.getElementById('kho-code-body');
        if (!data) return;

        let html = '';
        for (let id in data) {
            html = `<tr>
                <td>${data[id].name}</td>
                <td>${data[id].date}</td>
                <td><a href="${data[id].link}" target="_blank" style="color:#00ff00; text-decoration:none; font-weight:bold;">[T·∫¢I V·ªÄ]</a></td>
            </tr>` + html;
        }
        body.innerHTML = html;
    });
}

        function loadTopTen() {
    db.ref('users').on('value', snap => {
        const users = snap.val();
        if (!users) return;

        let userArray = [];
        for (let username in users) {
            userArray.push({
                name: username,
                balance: users[username].balance || 0
            });
        }

        // S·∫Øp x·∫øp ai nhi·ªÅu ti·ªÅn h∆°n ƒë·ª©ng tr∆∞·ªõc
        userArray.sort((a, b) => b.balance - a.balance);

        const top10 = userArray.slice(0, 10);
        let html = '';

        top10.forEach((user, index) => {
            let rank = index + 1;
            let icon = rank;
            let nameColor = "#eee";

            if (index === 0) { icon = 'üëë'; nameColor = "gold"; }
            else if (index === 1) { icon = 'ü•à'; nameColor = "silver"; }
            else if (index === 2) { icon = 'ü•â'; nameColor = "#cd7f32"; }

            html += `
                <tr style="border-bottom: 1px solid #222; background: rgba(255,255,255,0.03);">
                    <td style="text-align: center; font-weight: bold; padding: 12px;">${icon}</td>
                    <td style="font-weight: 600; color: ${nameColor}; padding: 12px;">${user.name}</td>
                    <td style="text-align: center; color: #00ff00; font-weight: bold; padding: 12px;">
                        ${user.balance.toLocaleString()}ƒë
                    </td>
                </tr>
            `;
        });
        document.getElementById('top-nap-body').innerHTML = html;
    });
}
// Ch·∫°y h√†m
loadTopTen();
        
</script>

<div class="contact-sidebar">
    <a href="https://zalo.me/84788265513" target="_blank" class="contact-item zalo">
        <i class="fa-solid fa-comment"></i>
    </a>
    
    <a href="https://facebook.com/nvh12072006" target="_blank" class="contact-item facebook">
        <i class="fa-brands fa-facebook-f"></i>
    </a>

    <a href="https://t.me/@kunmmo2006" target="_blank" class="contact-item telegram">
        <i class="fa-brands fa-telegram"></i>
    </a>
</div>
    
</body>
</html>
